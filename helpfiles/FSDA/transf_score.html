<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">


<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>Score test for transformation :: Robust Regression Analysis (Flexible Statistics Data Analysis Toolbox&trade;)</title>
<link href="docstyle.css" rel="stylesheet" type="text/css">
<meta content="refpage" name="chunktype">


<style type="text/css">
.style1 {
	font-family: "Times New Roman";
		vertical-align: middle;

}
</style>
<script  type="text/javascript" language="javaScript" src="bottom.js"></script>

</head>


<body>

<a name="top_of_page"></a>
<p style="font-size: 1px;">&nbsp;</p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr>
		<td valign="baseline"><b>Flexible Statistics Data Analysis Toolbox&trade;</b></td>
		<td align="right" valign="baseline"><a href="transf_intro.html">
		<img align="bottom" alt="Transformations in linear regression" border="0" src="images_help/b_prev.gif"></a>&nbsp;&nbsp;
		<a href="transf_fsrfan.html">
		<img align="bottom" alt="Forward Score test" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" class="feedbacklinktop" width="100%">
	<tr>
		<td>&nbsp;</td>
		<td align="right">
		<a href="mailto:toolboxFS@unipr.it?subject=feedback">Provide feedback on FSDA toolbox</a>
</td>
	</tr>
</table>
<a name="bq24of9-1"></a><a class="indexterm" name="zmw57dd0e69698"></a>
<h2>Score test for transformation</h2>
<!-- SYNCHTO: bq_w_hm.html -->
<p class="purpose">Approximate score test statistic for
testing the transformation &lambda; = &lambda;<sub>0</sub>  </p>
<p>
Box and Cox (1964) analyze the normalized power
transformation  
</p>
<p>
<img alt="Box-Cox" src="plots/Box-Cox.gif"></p>
<p>
where symbol y with dot on top denotes the geometric mean of the observations. 

When &lambda; = 1, there is no transformation: &lambda; = 1/2 is the square root
transformation, &lambda; = 0 gives the log transformation and &lambda; = &minus;1 the reciprocal.
These are the most widely used transformations, frequently supported
by some empirical reasoning. For example, measurements of concentration
often have a standard deviation proportional to the mean, so that the variance
of the logged response is approximately constant. For
this form of transformation to be applicable, all observations need to be
positive. For it to be possible to detect the need for a transformation the
ratio of largest to smallest observation should not be too close to one. A
similar requirement applies to the transformation of explanatory variables.

</p>
<p>

<br>The hope is that, for
some &lambda; which has to be estimated, the transformed
observations will satisfy the linear regression model.</p>
<p>
<img alt="zlambda" src="plots/Box-Cox1.gif"></p>
<p>
where <em>x</em> is <tt>p</tt>-times-1 and the errors  are independently
normally distributed with constant variance σ<sup>2</sup>. For inference about 
the transformation parameter &lambda;, Box and Cox suggest the likelihood ratio test 
statistic. For regression models, a computationally
simpler alternative test of the hypothesis
&lambda; = &lambda;<sub>0</sub> is the approximate score statistic derived by
Taylor series expansion of Eq. (1).



 </p>
<p>
<img alt="expansion"   class="style1"  src="plots/img11.gif">
<p>&nbsp; where&nbsp;<p>
<img alt="" src="plots/img15.gif">.</p>
<p>

</p>
<p>
If the linearized response (3) is substituted in the regression
model (2), the model becomes
</p>
<p>
<img alt="" src="plots/img1B.gif"></p>
<p>Because Eq. (4) is again a regression model with an
extra variable <em>w</em>(&lambda;<sub>0</sub>) derived from the transformation,
the new variable is called the constructed variable for
the transformation. If the true value of &lambda; is close to &lambda;<sub>0</sub>,
the coefficient (&lambda;-&lambda;<sub>0</sub>) of the constructed variable will
be small. The regression model (4) can be rewritten
more conventionally by putting  <em>γ</em> =-(&lambda;-&lambda;<sub>0</sub>) when;</p>
<p>
<img alt="" src="plots/img25.gif"></p>
<p>Small values of <em>γ</em> then indicate that no transformation
is necessary. The approximate score statistic for
testing the transformation &lambda; = &lambda;<sub>0</sub> (which is often denoted in the 
statistical literature with symbol <em>T<sub>p</sub></em>(&lambda;)) is just the <em>t</em>-statistic
for the coefficient of regression on <em>w</em>(&lambda;<sub>0</sub>) in Eq. (5).
</p>
<p></p>
<a name="bq9x7hn"></a><a name="bq5gf2y"></a>
<h3>Examples</h3>

<h3>Example 1</h3>
<p>Compute the score test for the <tt>wool dataset</tt>:</p>
<pre class="programlisting">
XX=load('wool.txt')
y=XX(:,end);
X=XX(:,1:end-1);
% Compute the score test using the five most common values of the transformation
% parameter
[outSc]=Score(y,X)

outSc.Score =

   17.7059
    7.4927
   -0.9122
   -9.5511
  -18.5576 </pre>
<p>The constructed variable is not significant when we consider 
&lambda;=0</p>
<h3>Example 2</h3>
<p>Compute the score test for the <tt>loyalty cards dataset</tt>:</p>
<pre class="programlisting">
load('loyalty.txt');
y=loyalty(:,4);
X=loyalty(:,1:3);
% la = vector containing the values of &lambda; which have to be tested
la=[0.25 1/3 0.4 0.5];
[outSc]=Score(y,X,'la',la);
outSc =
    4.3160
   -0.2124
   -3.8334
   -9.4717
</pre>
<p>Using all the observations it seems that the third root is the best value of the 
transformation parameter.</p>

<h3>See Also</h3>

<p><a href="score.html"><tt>Score</tt></a>, <a href="fsrfan.html"><tt>FSRfan</tt></a>,
<a href="fanplot.html"><tt>fanplot</tt></a></p>

<table border="0" cellpadding="0" cellspacing="0" class="feedbacklinkbot" width="100%">
	<tr>
		<td>&nbsp;</td>
		<td align="right">
		<a href="mailto:toolboxFS@unipr.it?subject=feedback">Provide feedback on FSDA toolbox</a>
</td>
	</tr>
</table>
<p></p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr valign="top">
		<td align="left" width="20"><a href="transf_intro.html">
		<img align="bottom" alt="lillietest" border="0" src="images_help/b_prev.gif"></a>
		</td>
		<td align="left">Transformations in linear regression</td>
		<td>&nbsp;</td>
		<td align="right">Forward Score test</td>
		<td align="right" width="20"><a href="transf_fsrfan.html">
		<img align="bottom" alt="linkage" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<script type ="text/javascript" language="javaScript">
document.write(barra);
</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->

</body>

</html>
