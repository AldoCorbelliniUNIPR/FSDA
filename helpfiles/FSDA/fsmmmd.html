<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<!--FScategory:Robust multivariate analysis and transformations-->


<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>FSMmmmd :: Functions (Flexible Statistics Data Analysis Toolbox&trade;)</title>
<link href="docstyle.css" rel="stylesheet" type="text/css">
<meta content="refpage" name="chunktype">

<script  type="text/javascript" language="javaScript" src="bottom.js"></script>

</head>


<body>

<a name="top_of_page"></a>
<p style="font-size: 1px;">&nbsp;</p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr>
		<td valign="baseline"><b>Flexible Statistics Data Analysis Toolbox&trade;</b></td>
		<td align="right" valign="baseline"><a href="fsminvmmd.html">
		<img align="bottom" alt="FSMfan" border="0" src="images_help/b_prev.gif" style="width: 17px"></a>&nbsp;&nbsp;
		<a href="fsmmmdeasy.html">
		<img align="bottom" alt="" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<a name="bq24of9-1"></a><a class="indexterm" name="zmw57dd0e69698"></a>
<h1 class="reftitle">FSMmmd</h1>
<p class="purpose">(FAST) Minimum Mahalanobis distance 
</p>
<h2>Syntax </h2>
<p class="synopsis"><tt>[mmd,Un] = FSMmmd(Y,bsb)<br>[mmd,Un,BB] = FSMmmd(Y,bsb,<i>param1</i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)<br>
</tt></p>
<a name="bq24of9-2"></a>
<h2>Description</h2>
<p><tt>[mmd,Un,BB] = FSMmmd(Y,bsb)</tt> 
stores the values of the minimum Mahalanobis distance and other 
multivariate quantities in each step of the forward search. This function is called from FSM in order to compute and store the information 
which is required to run the automatic outlier detection procedure. </p>
<p><em>Remark</em>: This routine performs the forward search with time
increasing almost linearly with the sample size. This makes its use with
datasets of very lage size feasible in reasonable time. This is possible
because this routine 1) uses efficient algorithms for both subset updating and
computation of Mahalanobis distances or residuals; these algorithms do not need
matrix inversion, but simple matrix multiplications, and avoid the use of
sorting procedures. 2) uses a selection of the best mixture of linear indexing
and logical indexing along the search; 3) optimizes the choice of the best
alternative between the matrix multiplication operator *. and the MATLAB
function @bsxfun; 4) uses a new procedure for finding the k-th order
statistics, to be used when computation of repeated minima becomes too
expensive (for further details see Riani, Perrotta and Cerioli, 2013; The
Forward Search for Very Large Datasets). Function <a
href="fsmmmdeasy.html">FSMmmdeasy </a>has the same input/ouptut of FSMmmd, is
much easier to understand, but it is much slower. Riani Perrotta and Cerioli
(2013) show that the new algorithms implemented in FSMmmd enable a reduction of
the computation time by more than 80% with respect to those implemented in <a
href="fsmmmdeasy.html">FSMmmdeasy</a>. </p>


  
</p>
<p>&nbsp;Y is an <i>n</i>-by-<i>p</i> matrix. 
Rows of Y represent observations, while columns represent variables . <tt>bsb</tt> is a vector containing the list 
of the units forming the initial subset. If <tt>bsb=0</tt> (default) then the procedure starts 
with p units randomly chosen else if bsb is not 0 the search will start with <tt>
m0=length(bsb)</tt></p>
<p><tt><a name="bq24of9-3"></a>[mmd,Un,BB] = FSMmmd(Y,bsb)</tt> returns the following 
information </p>
<ul type="disc">
	<li>
		<tt>mmd</tt> &minus; n-init x 2 matrix which contains the monitoring of 
		minimum Mahalanobis distance at each step of the 
		forward search. 
              <br>1st col = fwd search index (from init to n-1) 
              <br>2nd col = minimum Mahalanobis distance</li>
		
		<li>
		<p><tt>Un</tt> &minus; (n-init) x 11 matrix which contains the unit(s) included 
		in the subset at each step of the fwd search. <br>REMARK: in every step 
		the new subset is compared with the old subset. Un contains the unit(s) 
		present in the new subset but not in the old one.<br>Un(1,2) for example 
		contains the unit included in step init+1.<br>...<br>Un(end,2) contains the units 
		included in the final step of the search.</p>
		</li>

		
		<li>
		<p><tt>BB</tt> &minus; n x (n-init+1) matrix containing the information about the units belonging
              to the subset at each step of the forward search. 
              <br>1st col = indexes of the units forming subset in the initial step 
              <br>... 
              <br>last column = units forming subset in the final step (all units)</p></li>
              
           		
	</ul>
	<ul>
		<a name="zmw57dd0e69798"></a>
		<table border="1" cellpadding="5" cellspacing="0" class="note" summary="Note">
			<tr width="90%">
				<td>
				<p><b>Note</b>&nbsp;&nbsp; <tt>FSMmmd</tt> is nothing but a 
				simplified version of function <tt>FSMeda</tt>. </p>
				</td>
			</tr>
		</table>
	</ul>
	
<p></p>
<p><tt>[mmd,Un,BB] = FSMmmd(Y,bsb,<i><tt>param1</tt></i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)</tt> 
specifies one or more of the name/value pairs described in the following table.</p>
<table border="2" cellpadding="4" cellspacing="0" class="body">
	<colgroup>
		<col width="21%"><col width="79%">
	</colgroup>
	<thead>
		<tr valign="top">
			<th bgcolor="#B2B2B2">Parameter</th>
			<th bgcolor="#B2B2B2">Value</th>
		</tr>
	</thead>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;init&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>scalar, which specifies the point where to initialize the search
              and start monitoring required diagnostics. Notice that if bsb
              is supplied init>=length(bsb). if init is not specified it will be set equal to
		floor(n*0.6).</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2" style="height: 75px"><tt>&#39;msg&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 75px">
		<p>Scalar which controls whether to display or 
		not messages about great interchange on the screen<br>If msg=1 (default) 
		messages are displayed on the screen else no 
		message is displayed on the screen.</p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;plots&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p> If plots=1 a plot of minimum Mahalanobis 
		distance appears on the screen with 1%, 50% and 99% confidence 
		bands else (default) no plot is shown.</p>
		</td>
	</tr>
	</table>
<p></p>
<a name="bq9x7hn"></a><a name="bq5gf2y"></a>
<h3>Example 1</h3>

In this example we show the monitoring of the 
minimum Mahalanobis distance for a random subset of 200 observations with three 
contaminated observations. The Forward Search is run starting from an initial 
subset composed by the 4 observations which fell the smallest number of times outside the robust bivariate ellipses and with the 
lowest Mahalanobis Distance.

<pre class="programlisting">
    
n=200;
v=3;
m0=4;
randn('state',123456);
Y=randn(n,v);
%Contaminated data
Ycont=Y;
Ycont(1:5,:)=Ycont(1:5,:)+3;
[fre]=unibiv(Y);
%create an initial subset with the 4 observations, which fell the smallest
%number of times outside the robust bivariate ellipses, and with the 
%lowest Mahalanobis Distance.
fre=sortrows(fre,[3 4]);
bs=fre(1:m0,1);
[mmd,Un,BB]=FSMmmd(Ycont,bs,'plots',1);
</pre>


<img src="plots/fsmmmd.gif">
<p>


<h3>Example 2</h3>
<a name="example2"></a>This example has the purpose of comparing the computational time of the new function FSMmmd with 
that of the traditional function FSMmmdeasy.
<pre class="programlisting">
n=20000;
v=3;
n=20000;
v=3;
m0=10;
randn('state',123456);
Y=randn(n,v);
% 25\% of Contaminated data
Ycont=Y;
Ycont(1:5000,:)=Ycont(1:5000,:)+3;
[fre]=unibiv(Y);
%create an initial subset with the 4 observations, which fell the smallest
%number of times outside the robust bivariate ellipses, and with the
%lowest Mahalanobis Distance.
fre=sortrows(fre,[3 4]);
bs=fre(1:m0,1);    
% Compare the computational time of FSMmmd with that of FSMmmdeasy
tic;
[mmd,Un]=FSMmmd(Ycont,bs);
toc;
tic;
[mmd,Un]=FSMmmdeasy(Ycont,bs);
toc;
</pre>  
    
    
<br>
<p>In out computer running the above produced the following output</p>
<p>
<pre class="programlisting">
Warning: interchange greater than 10 when m=16667
Number of units which entered=11
Elapsed time is 22.007305 seconds.
Warning: interchange greater than 10 when m=16667
Number of units which entered=11
Elapsed time is 159.585365 seconds.
</pre> 
</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3>See Also</h3>

<p><a href="fsm.html"><tt>FSM</tt></a>, <a href="fsmeda.html"><tt>FSMeda</tt></a>,
<a href="fsminvmmd.html"><tt>FSMinvmmd</tt></a>, <a href="fsmmmdeasy.html"><tt>FSMmmdeasy</tt></a></p>
<p>&nbsp;</p>
<p></p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr valign="top">
		<td align="left" width="20"><a href="fsminvmmd.html">
		<img align="bottom" alt="FSMfan" border="0" src="images_help/b_prev.gif"></a>
		</td>
		<td align="left">fsminvmmd.html</td>
		<td>&nbsp;</td>
		<td align="right">fsmmmdeasy.html</td>
		<td align="right" width="20"><a href="fsmmmdeasy.html">
		<img align="bottom" alt="" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<script type ="text/javascript" language="javaScript">
document.write(barra);
</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->

</body>

</html>
