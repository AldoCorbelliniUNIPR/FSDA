<html>
<head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <title>GetOmegaMap :: Functions (Flexible Statistics Data Analysis Toolbox™)</title>
  <link href="docstyle.css" rel="stylesheet" type="text/css">
  <meta content="refpage" name="chunktype">
  <meta content="function:FSM" name="refentity">
  <meta content="text/javascript" http-equiv="Content-Script-Type">
  <meta content="fcn" name="toctype">
  <script type="text/javascript" language="javaScript" src="bottom.js">
  </script>
  <style type="text/css">
  .auto-style1 {
	  margin-bottom: 0px;
  }
  </style>
</head>

<body>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<!--FScategory:Clustering-->
<a name="top_of_page"></a> 

<p style="font-size: 1px;">&nbsp;</p>

<table border="0" cellpadding="0" cellspacing="0" class="nav"
summary="Navigation aid" width="100%">
  <tbody>
    <tr>
      <td valign="baseline"><b>Flexible Statistics Data Analysis
      Toolbox™</b></td>
      <td align="right" valign="baseline"><a href="fscolors.html"><img
        align="bottom" alt="fanplot" border="0"
        src="images_help/b_prev.gif"></a>   <a href="fsmbbm.html"><img
        align="bottom" alt="FSMeda" border="0"
      src="images_help/b_next.gif"></a></td>
    </tr>
  </tbody>
</table>

<table border="0" cellpadding="0" cellspacing="0" class="feedbacklinktop"
width="100%">
  <tbody>
    <tr>
      <td>&nbsp;</td>
      <td align="right"><a
        href="mailto:toolboxFS@unipr.it?subject=feedback">Provide feedback on
        FSDA toolbox</a> </td>
    </tr>
  </tbody>
</table>

<h1 class="reftitle">GetOmegaMap</h1>

<p class="purpose">Calculates the map of misclassificaton between groups </p>

<h2>Syntax </h2>

<p class="synopsis"><tt>[OmegaMap, BarOmega, MaxOmega, rcMax] = GetOmegaMap(c, 
v, k, li, di, const1, fix, tol, lim, asympt)<br>
[OmegaMap, BarOmega, MaxOmega, rcMax] = GetOmegaMap(c, v, k, li, di, const1, fix, tol, lim, asympt, toll)<br>
</tt></p>
<a name="f4811966"></a> 

<h2>Description </h2>

<p>Background: Given two generic clusters i and j with&nbsp; i &ne;&nbsp; j =1, ..., k,        
indexed by &phi;(x; μ<sub>i</sub>,&Sigma;<sub>i</sub>) and φ(x; μ<sub>j</sub>,&Sigma;<sub>j</sub>) with          
probabilities of occurrence &pi;<sub>i</sub> and &pi;<sub>j</sub>&nbsp;, the misclassification          
probability with respect to cluster i, (that is conditionally on x belonging to 
cluster i,&nbsp; which is called w<sub>j|i</sub>) is defined as
Pr[&pi;<sub>i</sub>&nbsp; φ(x; μ<sub>i</sub>,&Sigma;<sub>i</sub>) < &pi;<sub>j</sub>&nbsp; 
φ(x; μ<sub>j</sub>,&Sigma;<sub>j</sub>)].          
The matrix containing the misclassification probabilities w<sub>j|i</sub> is         
called <a href="#OmegaMap">OmegaMap</a>. The probability of overlapping, defined as a sum of two 
misclassification probabilities, measures the degree of interaction between 
components and can be readily employed to control the clustering complexity of 
datasets simulated from mixtures. These datasets can then be used for systematic 
performance investigation of clustering and finite mixture modeling algorithms. 
More specifically, the probability of overlapping between groups i and j (called p<sub>ij</sub>) is given by 
p<sub>ij </sub>=p<sub>ji </sub>= w<sub>j|i</sub> + w<sub>i|j</sub> = 
OmegaMap(i,j)+OmegaMap(j,i),&nbsp;          i,j=1,2, ..., k.                           
The diagonal elements of OmegaMap are (by definition) set equal to 1.                          
The average overlap (which in the code below&nbsp; is called <a href="#BarOmega">BarOmega</a>) is        
defined as the sum of the off diagonal elements of OmegaMap (Σ<sub>i &gt; j=1,2, 
..., k</sub> p<sub>ij </sub>) divided by k(k-1)/2.                    
The maximum overlap (which in the code below is called <a href="#MaxOmega">MaxOmega</a>) is defined as   
max(w<sub>j|i</sub> + w<sub>i|j</sub> ) = max p<sub>ij </sub>&nbsp;i &ne; j=1,2, ..., k. The standard 
deviation of overlap (which in the code is called <a href="#StdOmega">StdOmega</a>) is the standard 
deviation of the k(k-1)/2 elements&nbsp; p<sub>ij</sub>. The probability of misclassification w<sub>j|i</sub> (w<sub>i|j</sub>) is nothing but the cdf of a linear    
combination of non central &Chi;<sup>2</sup> distributions with 1 degree of freedom    
+ a linear combination of N(0,1) evaluated in a                            
point c.  The coefficients of the linear combinations of non central       
&Chi;<sup>2</sup> and N(0,1) depend on the eigenvalues and eigenvectors of matrix      
Σ<sub>j|i</sub> = Σ<sup>0.5</sup><sub>i</sub> Σ<sup>-1</sup><sub>j </sub>Σ<sup>0.5</sup><sub>i</sub>.                  
Point c depends on the same eigenvalues and eigenvectors                   
of matrix Σ<sub>j|i</sub>, the mixing proportions&nbsp; π<sub>i</sub> and &pi;<sub>j </sub>and the       
determinants |Σ<sub>i</sub>| and |Σ<sub>j</sub>|.                                     
This probability is computed using routine <a href="ncx2mixtcdf.html">ncx2mixtcdf</a>.</p>

<p>GetOmegaMap admits the following inputs</p>

<p>&nbsp;</p>

<table cellspacing="0" class="body" cellpadding="4" border="2"><colgroup><col width="29%"><col width="71%"></colgroup><tbody><tr valign="top"><td>
	<p class="auto-style1">
	<tt>c</tt></p></td><td><p>       scalar, inflation parameter for covariance matrices. In the
            case of heterogeneous clusters scalar c is used to correct
            li(i,j) and const1(i,j). <br>More precisely when hom=0 <br>if fix(i)=0 di(i,j,:)=di(i,j,:)/c<sup>0.5</sup>
                   (because di(i,j,:)=&Gamma; (c &Sigma;<sub>i</sub>)<sup>-0.5</sup>(&mu;<sub>i</sub>-&mu;<sub>j</sub>) 
	where Gamma is the matrix of eigenvectors of&nbsp; Σ<sub>j|i</sub> = Σ<sup>0.5</sup><sub>i</sub> Σ<sup>-1</sup><sub>j </sub>Σ<sup>0.5</sup><sub>i</sub>.)
           <br>if fix(i)=0 and fix(j)=1  li(i,j,:)=c li(i,j,:), <br>const1(i,j)=const1(i,j)+v log(c)
                   (because the eigenvalues of matrix
                   &Sigma;<sub>j|i</sub> = (c<sup>0.5</sup> &Sigma;<sub>i</sub><sup>0.5</sup>) &Sigma;_j<sup>-1</sup> (c<sup>0.5</sup>
                   &Sigma;<sub>i</sub><sup>0.5</sup>) are multiplied by c.
                   Similarly log |c&Sigma;<sub>i</sub>|= c*log(v) + log |&Sigma;<sub>i</sub>|
           <br>if fix(i)=0  and fix(j)=0  li and const1 are not changed because
                   &Sigma;<sub>j|i</sub>=(c<sup>0.5</sup> &Sigma;<sub>i</sub><sup>0.5</sup>) (c &Sigma;_j) <sup>-1</sup> (c<sup>0.5</sup>
                   &Sigma;<sub>i</sub><sup>0.5</sup>)
                   const1(i,j)=log((Pi(j)/Pi(i))^2 * c detS(i)/(c detS(j)))
                   remain unaltered</p>
	</td></tr>
<tr valign="top"><td><p><tt>v</tt></p></td><td><p>scalar, dimensionality (number of variables)</p></td></tr>
	<tr>
		<td><p><tt>k</tt></p></td><td><p>scalar, number of components (groups)</p></td>
	</tr>
	</tbody></table>
	
	<p>li, di and const1 are the parameters needed for computing
           overlap</p>
           
<table cellspacing="0" class="body" cellpadding="4" border="2"><colgroup><col width="29%"><col width="71%"></colgroup><tbody>
	<tr>
		<td><p><tt>li</tt></p></td><td><p>3D array of size k-by-k-by-v. li(i,j,:) is the vector which
            contains the eigenvalues of matrix Σ<sub>j|i</sub> = Σ<sup>0.5</sup><sub>i</sub> Σ<sup>-1</sup><sub>j </sub>Σ<sup>0.5</sup><sub>i</sub> .
            Remark: li(i,j,:)-1 are the coefficients of the linear
            combinations of non central chi^2 distribution which is used
            to compute the probability of overlapping
            The non centrality parameter  of the non central chi^2 distribution
            associated with li(i,j,l)-1 is (li(i,j,l) di(i,j,l)/(li(i,j,l)-1))<sup>2</sup></p></td>
	</tr>
	<tr>
		<td><p><tt>di</tt></p></td><td><p>3D array of size k-by-k-by-p
            di(i,j,l)=&gamma;<sub>l</sub> ' Σ<sub>i</sub><sup>-0.5</sup>(&mu;<sub>i</sub>-&mu;<sub>j</sub>)l=1, 2, ...,v, whereγ<sub>l</sub> is the l-th eigenvector coming
            from the spectral decomposition of matrix Σ<sub>j|i</sub>  . Vector
            di(i,j,:) contains the coefficients of N(0,1) (called W_l in
            equation 2.2 of Maitra and Melnikov (2010), JCGS)</p></td>
	</tr>
<tr valign="top"><td><p><tt>const1</tt></p></td><td><p>k-by-k matrix whise element i,j with i=1,..., k and j=1, ..., k
            is equal to log((Pi(j)/Pi(i))^2 * detS(i)/detS(j))
            where detS(i) and detS(j) are, respectively, the
            determinants of the covariance matrices of groups i and j. See
            equation (2.2) of Maitra and Melnikov (2010), JCGS
            Note that const1(j,i)=-const1(i,j). The elements on the
            diagonal of matrix const1 are set to 0 (in other words they
            are not computed).</p></td></tr>
</tbody></table>
         <p>Vector fix specifies which are the groups whose covariance matrix has to be multiplied by c.</p>  
<table cellspacing="0" class="body" cellpadding="4" border="2"><colgroup><col width="29%"><col width="71%"></colgroup><tbody>
	<tr>
		<td style="width: 349px"><p><tt>fix</tt></p></td><td><p>vector of length 
		k containing zeros or ones<br>if fix(j) =1 cluster j does not 
		participate to inflation or deflation. If fix=zeros(k,1) all clusters 
		participate in<br>inflation/deflation <br>REMARK: this parameter is used 
		just if heterogeneous clusters<br>are used</p></td>
	</tr>
</tbody></table>
<p>Parameters tol and lim will be used by
               function <a href="ncx2mixtcdf.html">ncx2mixtcdf</a> which 
computes the cdf of a linear combination of non central chi2 r.v.. This is the 
probability of misclassification</p>
           
<table cellspacing="0" class="body" cellpadding="4" border="2"><colgroup><col width="29%"><col width="71%"></colgroup><tbody>
	<tr>
		<td style="width: 339px"><p><tt>tol</tt></p></td><td><p>scalar. Error bound for overlap computation default is 1e-06</td>
	</tr>
	<tr>
		<td style="width: 339px"><p><tt>lim</tt></p></td><td><p>3D array of size k-by-k-by-p
            di(i,j,l)=&gamma;<sub>l</sub> ' Σ<sub>i</sub><sup>-0.5</sup>(&mu;<sub>i</sub>-&mu;<sub>j</sub>) l=1, 2, ...,v, whereγ<sub>l</sub> is the l-th eigenvector coming
            from the spectral decomposition of matrix Σ<sub>j|i</sub>  . Vector
            di(i,j,:) contains the coefficients of N(0,1) (called W_l in
            equation 2.2 of Maitra and Melnikov (2010), JCGS)</p></td>
	</tr>
<tr valign="top"><td style="width: 339px"><p><tt>const1</tt></p></td><td><p>
	maximum number of integration terms default is 1e06.</p></td></tr>
</tbody></table>
           
<p>asympt is a flag for regular or asymptotic overlap</p>
           
<table cellspacing="0" class="body" cellpadding="4" border="2"><colgroup><col width="29%"><col width="71%"></colgroup><tbody>
	<tr>
		<td style="width: 349px"><p><tt>asympt</tt></p></td><td><p>If asympt ==1 formula
            of asymptotic overlap is used (see p. 359, paragraph starting
            with step 3 of Maitra and Melnikov, 2010, JCGS). <br>More precisely,&nbsp; 
		if&nbsp; clusters i and j have different covariance matrices&nbsp;
            the misclassification probability w<sub>j|i</sub> (that is with
            respect to the centroid and covariance matrix of group i) is
            given by
            &Sigma;<sub>l=1</sub><sup>p</sup> (&lambda;<sub>l</sub>-1) &Chi;<sup>2</sup><sub>1</sub> &le;&nbsp; log &pi;<sub>j</sub><sup>2</sup> |&Sigma;<sub>j</sub>| / 
		π<sub>i</sub><sup>2</sup> |&Sigma;<sub>i</sub>| where Χ<sup>2</sup><sub>1 </sub> are central 
		Χ<sup>2 </sup>with one degree of freedom and λ<sub>l</sub> are the eigenvalues of matrix 
		Σ<sub>j|i</sub>. The sum is in correspondence of the eigenvalues which 
		are not equal 1.</p>
		<p>If, on the other hand, clusters i and j have the same covariance 
		matrix </p>
		<p>Note that parameter asympt is set to 1 in the preliminary
            phase just to check whether the requested average or&nbsp; maximum 
		or standard deviation of overlap
            can be reached.</p></td>
	</tr>
</tbody></table>
<p>&nbsp;          Background: the probability of overlapping is the result of two
           sums. The first is a sum in correspondence of the eigenvalues
           of matrix&nbsp; Σ<sub>j|i </sub>not equal 1. The second is a sum in
           correspondence of the eigenvalues of matrix&nbsp; Σ<sub>j|i </sub>&nbsp;equal 1.
           Similarly, what is on the right hand side of the probability of
           overlapping has two sums (for eigenvalues equal or different from 1). Optional parameter toll specifies when we must consider an
           eigenvalue equal to 1.</p>
           
<table cellspacing="0" class="body" cellpadding="4" border="2"><colgroup><col width="29%"><col width="71%"></colgroup><tbody>
	<tr>
		<td style="width: 349px"><p><tt>toll</tt></p></td><td><p>scalar, tolerance use to declare the eigenvalues of matrix 
		Σ<sub>j|i </sub>&nbsp;equal to 1. The default value is 1e-06</p></td>
	</tr>
</tbody></table>

<p><tt>[OmegaMap, BarOmega, MaxOmega, rcMax] = GetOmegaMap(c, 
v, k, li, di, const1, fix, tol, lim, asympt)</tt> returns the following information </p>
  <ul type="disc">
      <li><tt><a name="OmegaMap">OmegaMap</a></tt> matrix of misclassification probabilities (k-by-k);
	  <br>OmegaMap(i,j) = w<sub>j|i</sub> is the probability that X coming from the 
	  i-th component (group) is classified to the j-th component. </li>
      <li><tt><a name="BarOmega">BarOmega</a></tt>  − scalar. Value of average overlap. BarOmega is computed as
	  <br>(sum(sum(OmegaMap))-k)/(0.5*k(k-1)) </li>
      <li><tt><a name="MaxOmega">MaxOmega</a></tt> − scalar. Value of average overlap.&nbsp; MaxOmega 
	  is the<br>&nbsp;maximum of OmegaMap(i,j)+OmegaMap(j,i). In other words 
	  MaxOmega=<br>&nbsp;OmegaMap(rcMax(1),rcMax(2))+OmegaMap(rcMax(2),rcMax(1))</li>
		<li><p><tt>rcMax</tt> − vector of length 2. It containes the row and 
		column numbers associated with the pair of components<br>producing 
		maximum overlap 'MaxOmega'</p>
      </li>
    </ul>

<h2>Examples</h2>
    <p></p>

<h3>Example 1</h3>
<p>Finding exact overlap for the Iris data. Group 1 is far from groups 2 and 3. 
The overlap between groups 2 and 3 is large</p>
&nbsp;<pre class="programlisting">
     load fisheriris;                                                        
    Y=meas;                                                                 
    Mu=grpstats(Y,species);                                                 
                                                                            
    S=zeros(4,4,3);                                                         
    S(:,:,1)=cov(Y(1:50,:));                                                
    S(:,:,2)=cov(Y(51:100,:));                                              
    S(:,:,3)=cov(Y(101:150,:));                                             
                                                                            
    pigen=ones(3,1)/3;                                                      
    k=3;                                                                    
    p=4;                                                                    
    [OmegaMap, BarOmega, MaxOmega, StdOmega, rcMax]=overlap(k,p,pigen,Mu,S)    
    disp('Omegamap= k-by-k matrix which contains misclassification probabilities')
    disp(OmegaMap);
    disp('Average overlap')
    disp(BarOmega)
    disp('Maximum overlap')
    disp(MaxOmega)
    disp('Groups with maximum overlap')
    disp(rcMax)
</pre>

<p>&nbsp;</p>

<p>The output of this example is as follows</p>
<pre>OmegaMap= k-by-k matrix which contains misclassification probabilities
    1.0000    0.0000         0
    0.0000    1.0000    0.0230
         0    0.0263    1.0000</pre>
<pre>Average overlap
    0.0164</pre>
<pre>Maximum overlap
    0.0493</pre>
<pre>Groups with maximum overlap
     2
     3</pre>
<p>&nbsp;</p>
<h3>See Also</h3>

<p><tt><a href="mixsim.html">MixSim</a></tt>,<tt> <a href="simdataset.html">simdataset</a></tt> </p>

<table border="0" cellpadding="0" cellspacing="0" class="feedbacklinkbot"
width="100%">
  <tbody>
    <tr>
      <td> </td>
      <td align="right"><a
        href="mailto:toolboxFS@unipr.it?subject=feedback">Provide feedback on
        FSDA toolbox</a> </td>
    </tr>
  </tbody>
</table>

<p></p>

<table border="0" cellpadding="0" cellspacing="0" class="nav"
summary="Navigation aid" width="100%">
  <tbody>
    <tr valign="top">
      <td align="left" width="20"><a href="fscolors.html"><img align="bottom"
        alt="fanplot" border="0" src="images_help/b_prev.gif"></a> </td>
      <td align="left">fscolors.html</td>
      <td> </td>
      <td align="right">fsmbbm.html</td>
      <td align="right" width="20"><a href="fsmbbm.html"><img align="bottom"
        alt="FSMeda" border="0" src="images_help/b_next.gif"></a></td>
    </tr>
  </tbody>
</table>
<script type="text/javascript" language="javaScript">
document.write(barra);</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->
</body>
</html>
