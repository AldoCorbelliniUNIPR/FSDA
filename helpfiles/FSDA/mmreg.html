<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<!--FScategory:Robust Regression Analysis and transformations-->


<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>MMreg :: Functions (Flexible Statistics Data Analysis Toolbox&trade;â„¢)</title>
<link href="docstyle.css" rel="stylesheet" type="text/css">
<meta content="refpage" name="chunktype">


<script  type="text/javascript" language="javaScript" src="bottom.js"></script>

</head>


<body>

<a name="top_of_page"></a>
<p style="font-size: 1px;">&nbsp;</p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr>
		<td valign="baseline"><b>Flexible Statistics Data Analysis Toolbox&trade;</b></td>
		<td align="right" valign="baseline"><a href="mmmultcore.html">
		<img align="bottom" alt="levfwdplot
" border="0" src="images_help/b_prev.gif"></a>&nbsp;&nbsp;
		<a href="mmregcore.html">
		<img align="bottom" alt="minplot" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<a name="bq24of9-1"></a><a class="indexterm" name="zmw57dd0e69698"></a>
<h1 class="reftitle">MMreg</h1>
<p class="purpose">MM estimators in linear regression (using S estimators as 
starting values)</p>
<h2>Syntax </h2>
<p class="synopsis">
<tt>
[out] = MMreg(y,X)<br>[out] = MMreg(y,X,<i><tt>param1</tt></i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)<br>
[out,<i><tt>varargout</tt></i>] = MMreg(y,X,...);
</tt>
</p>

<h2>Description</h2>
<p><tt>[out] = MMreg(y,X)</tt> computes MM estimators in linear regression. 
An S-estimator is used as starting value, and an M estimator
with fixed scale and redescending psi Tukey biweight function is used from there. The default nominal efficiency which 
is used is 95%.</p>
<p><tt>y</tt> is a vector of length n containing the response values, while <tt>
X</tt> is the <i>n</i>-by-<i>p</i>-1 matrix which contains (in the columns) the values 
of <i>p</i>-1 predictive terms</p>

<p>
If an optional output variable is specified for <tt>varargout</tt>, the matrix of 
the indices of the samples extracted for computing the initial S estimator is returned in that variable.
</p>


<p><tt><a name="bq24of9-3"></a>[out] = MMreg(y,X)</tt> returns the following information
</p>
<ul type="disc">
	<li><tt>out</tt> &minus; A structure of additional statistics with the following fields.
	<ul type="circle">
		
		<li>
		<p><tt>beta</tt> &minus; <i>p</i>-by-1 vector of beta MM coefficient estimates, including 
		the intercept when input options <tt>intercept</tt> is equal to 1 or it 
		is missing. <tt>out.beta=[intercept slopes]</tt>.</p>
		</li>
		<li>
		<p><tt>auxscale</tt> &minus; scalar, S estimate of the scale (or supplied
                          external estimate of scale, if option InitialEst is not
                          empty).</p>
		</li>
		<li>
		<p><tt>residuals</tt> &minus; <i>n</i>-by-1 vector containing the scaled residuals from 
		the MM loop.      out.residuals=(y-X*out.beta)/out.auxscale</p>
		</li>
		<li>
		<p><tt>weights</tt> &minus; <i>n</i>-by-1 Boolean vector containing weights for each observations. 
		The elements of this vector lie in the interval 0 or 1. Elements close 
		to 0 values are associated with the outliers. </p>
		</li>
		
		<li>
		<p><tt>Sbeta</tt> &minus; <i>p</i>-by-1 vector of beta S coefficient estimates, including 
		the intercept when input options <tt>intercept</tt> is equal to 1 or it 
		is missing. </p>
		</li>

		
		<li>
				<p><tt>Ssingsub</tt> &minus;  Number of subsets without full rank in the S preliminary part. Notice that if
                      this number is greater than 0.1*(number of
                      subsamples) a warning is produced on the screen </p>
		<p><tt>outliers</tt> &minus; this output is present only if <tt>conflev</tt> has been specified. 
		It is a vector containing the list of the units declared as outliers using 
		confidence level specified in input scalar <tt>conflev</tt></p>
		</li>
		<li>
		<p><tt>conflev</tt> &minus; confidence level which is used to declare outliers. 
		Remark: scalar out.conflev will be used to draw the horizontal lines (confidence 
		bands) in the plots. If <tt>conflev</tt> is not specified a nominal 0.975
        confidence interval will be used.</p>
		</li>

<li>
<p><tt>y</tt> &minus; Response vector y. The field is present if option yxsave is set to 1. </p>
</li>
 
<li>
<p><tt>X</tt> &minus; Data matrix X. The field is present if option yxsave is set to 1. </p>
</li>


		<li>
		<p><tt>class</tt> &minus; string containing <tt>&#39;MM&#39;</tt> </p>
		</li>
	</ul>
	</li>
</ul>
<p></p>
<p><tt>[out] = MMreg(y,X,<i><tt>param1</tt></i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)</tt> 
specifies one or more of the name/value pairs described in the following table.</p>
<table border="2" cellpadding="4" cellspacing="0" class="body">
	<colgroup>
		<col width="21%"><col width="79%">
	</colgroup>
	<thead>
		<tr valign="top">
			<th bgcolor="#B2B2B2">Parameter</th>
			<th bgcolor="#B2B2B2">Value</th>
		</tr>
	</thead>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;intercept&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>If 1, a model with constant term will be fitted (default) else no constant 
		term will be included.  </p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;InitialEst&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p> A structure containing starting values of the MM-estimator.
              The structure must contain
             <br> - loc =  v x 1 vector (estimate of the centroid)
             <br> - scale = scalar (estimate of the scale parameter).
             <br> If InitialEst is empty (default)
              program uses S estimators. In this last case it is
              possible to specify the options in function <a href="sreg.html">
		Sreg</a>.</p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;eff&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>scalar defining nominal efficiency (i.e. a number between<br>0.5 and 
		0.99). The default value is 0.95</p></td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;effshape&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		dummy scalar. If effshape=1 efficiency refers to shape efficiency
                else (default) efficiency refers to location.</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;maxiter&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>scalar defining maximum number of iterations in the MM
                loop. 
                Default value is 100</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;tol&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>scalar controlling tolerance in the MM loop.
                Default value is 1e-7</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;conflev&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Scalar between 0 and 1 containing confidence level which is 
              used to declare units as outliers. 
              Usually <tt>0.95, 0.975, 0.99</tt> (individual alpha) 
              or <tt>1-0.05/n, 1-0.025/n, 1-0.01/n</tt> (simultaneous alpha).
              Default value is 0.975</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;conflev&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Scalar between 0 and 1 containing confidence level which is 
              used to declare units as outliers. 
              Usually <tt>conflev=[0.95, 0.975, 0.99]</tt> (individual alpha) 
              or <tt>[1-0.05/n, 1-0.025/n, 1-0.01/n]</tt> (simultaneous alpha).
              Default value is 0.975</p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;plots&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>Scalar. If <tt>plots=1</tt> a plot with robust residuals is produced 
		else (default) no plot is produced.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;nocheck&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>Scalar. If <tt>nocheck=1</tt> no check is performed on matrix y and 
		matrix X. Notice that y and X are left unchanged. In other words the additional 
		column of ones for the intercept is not added. As default <tt>nocheck=0</tt>. The controls
              on <tt>h</tt>, <tt>alpha</tt> and <tt>nsamp</tt> still remain.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;msg&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>Scalar which controls whether to display or not messages
              on the screen If <tt>msg=1</tt> (default) messages are displayed
              on the screen about estimated time to compute the estimator
              else no message is displayed on the screen. </p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;nomes&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>Scalar. If <tt>nomes</tt> is equal to 1 no message about estimated time to compute
		LMS is displayed, else if nomes is equal to 0 (default), a message about estimated
		time is displayed.</p>
		</td>
	</tr>
    <tr>
        <td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;yxsave&#39;</tt></td>
        <td bgcolor="#F2F2F2" style="height: 32px">
    <p>
       scalar that is set to 1 to request that the data <tt>y</tt> and <tt>X</tt>
       are saved into the output structure <tt>out</tt>.  
       Default is 0, i.e. no saving is done.
      </p>
    </td>
    </tr>

	</table>
<p></p>
<a name="bq9x7hn"></a><a name="bq5gf2y"></a>
<h3>Examples</h3>
<p>
In these examples we use the same data which have been used 
in the help of function <a href="fsr.html">FSR</a> and <a href="fsr.html">LXS</a> in order to compare the output of different procedures.
</p>


<pre class="programlisting">
state=100;
randn('state', state);
n=100;
X=randn(n,3);
bet=[3;4;5];
y=3*randn(n,1)+X*bet;
y(1:20)=y(1:20)+13;
</pre>


<p>For outlier detection we consider both the nominal individual 1% significance 
level and the simultaneous Bonferroni confidence level.&nbsp; </p>

<pre class="programlisting">
% Define nominal confidence level
conflev=[0.99,1-0.01/length(y)];
% Define number of subsets 
nsamp=3000;
% Define the main title of the plots
titl='';

% MM  estimators 
[outMM]=MMreg(y,X,'conflev',conflev(1));
laby='Scaled MM residuals'; 
resindexplot(outMM.residuals,'title',titl,'laby',laby,'numlab','','conflev',conflev)
</pre>
<p><img alt="" src="images_help/img23.gif"></p>
<p>
In this example MM estimator seems to 
detect half of the outlier with a Bonferroni significance level.&nbsp;&nbsp;
</p>
<p>In this second example we simply change the seed to 543 (<tt>state=543</tt>). Using a Bonferroni size of 1%, 
no unit is declared as outlier and just halp of them using the 99% band.&nbsp; </p>
<p><img alt="" src="images_help/img25.gif"></p>
<br><br>

Playing with the seeds you will see that the situation in which the application of 
traditional robust estimators does not seem able to reveal the outliers is not so uncommon. 
For example, similar results are obtained using seeds, 70,796, 210, 238, 320, 543.  

You can compare the output with that which comes out from procedure 
<a href="fsr.html">FSR</a> or from the <a href="resfwdplot.html">monitoring residuals plot</a>.


<h3>See Also</h3>

<p><a href="mmmult.html"><tt>MMmult</tt></a>,<a href="sreg.html"><tt>Sreg</tt></a>  <a href="smult.html"><tt>Smult</tt></a>,
<a href="mmregcore.html"><tt>MMregcore</tt></a></p>
 
 
<p></p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr valign="top">
		<td align="left" width="20"><a href="mmmultcore.html">
		<img align="bottom" alt="levfwdplot
" border="0" src="images_help/b_prev.gif" style="height: 17px"></a>
		</td>
		<td align="left">mmmultcore.html</td>
		<td>&nbsp;</td>
		<td align="right">mmregcore.html</td>
		<td align="right" width="20"><a href="mmregcore.html">
		<img align="bottom" alt="malfwdplot" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<script type ="text/javascript" language="javaScript">
document.write(barra);
</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->

</body>

</html>
