<html>
<head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <title>FSMmmdeasy :: Functions (Forward Search Data Analysis
  Toolbox™)</title>
  <link href="docstyle.css" rel="stylesheet" type="text/css">
  <meta content="refpage" name="chunktype">
  <script type="text/javascript" language="javaScript" src="bottom.js">
 </script>
</head>

<body>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<a name="top_of_page"></a> 

<p style="font-size: 1px;"> </p>

<table border="0" cellpadding="0" cellspacing="0" class="nav"
summary="Navigation aid" width="100%">
  <tbody>
    <tr>
      <td valign="baseline"><b>Forward Search Data Analysis Toolbox™</b></td>
      <td align="right" valign="baseline"><a href="fsmmmd.html"><img
        align="bottom" alt="FSMfan" border="0" src="images_help/b_prev.gif"
        style="width: 17px"></a>   <a href="fsmtra.html"><img align="bottom"
        alt="" border="0" src="images_help/b_next.gif"></a></td>
    </tr>
  </tbody>
</table>

<table border="0" cellpadding="0" cellspacing="0" class="feedbacklinktop"
width="100%">
  <tbody>
    <tr>
      <td> </td>
      <td align="right"><a
        href="mailto:toolboxFS@unipr.it?subject=feedback">Provide feedback on
        FSDA toolbox</a> </td>
    </tr>
  </tbody>
</table>
<a name="bq24of9-1"></a><a class="indexterm" name="zmw57dd0e69698"></a> 

<h1 class="reftitle">FSMmmdeasy</h1>

<p class="purpose">Minimum Mahalanobis distance </p>

<h2>Syntax </h2>

<p class="synopsis"><tt>[mmd,Un,BB] = FSMmmdeasy(Y,bsb)<br>
[mmd,Un,BB] =
FSMmmdeasy(Y,bsb,<i>param1</i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)<br>
</tt></p>
<em>REMARK: this function has the same input/output of function <a
href="fsmmmd.html">FSMmmd</a>. However, differently form <a
href="fsmmmd.html">FSMmmd</a> it does not use a recursive implementation to
compute Mahalanobis distances at each step. This function is kept because it is
very easy to understand. The difference in performances between FSMmmd and
FSMmmdeasy is negligible when when n is very small (n&lt;100) but becomes huge
as the the sample size increases. For a detailed comparison of the computing
times between the two functions see (Riani, Perrotta and Cerioli,
2013).</em><br>
<a name="bq24of9-2"></a> 

<h2>Description</h2>

<p><tt>[mmd,Un,BB] = FSMmmd(Y,bsb)</tt> stores the values of the minimum
Mahalanobis distance and other multivariate quantities in each step of the
forward search. This function is called from FSM in order to compute a store
the information which is required to run the automatic outlier detection
procedure. </p>

<p> Y is an <i>n</i>-by-<i>p</i> matrix. Rows of Y represent observations,
while columns represent variables . <tt>bsb</tt> is a vector containing the
list of the units forming the initial subset. If <tt>bsb=0</tt> (default) then
the procedure starts with p units randomly chosen else if bsb is not 0 the
search will start with <tt>m0=length(bsb)</tt></p>

<p><tt><a name="bq24of9-3"></a>[mmd,Un,BB] = FSMmmd(Y,bsb)</tt> returns the
following information </p>
<ul type="disc">
  <li><tt>mmd</tt> − n-init x 2 matrix which contains the monitoring of
    minimum Mahalanobis distance at each step of the forward search. <br>
    1st col = fwd search index (from init to n-1) <br>
    2nd col = minimum Mahalanobis distance</li>
  <li><p><tt>Un</tt> − (n-init) x 11 matrix which contains the unit(s)
    included in the subset at each step of the fwd search. <br>
    REMARK: in every step the new subset is compared with the old subset. Un
    contains the unit(s) present in the new subset but not in the old one.<br>
    Un(1,2) for example contains the unit included in step init+1.<br>
    ...<br>
    Un(end,2) contains the units included in the final step of the search.</p>
  </li>
  <li><p><tt>BB</tt> − n x (n-init+1) matrix containing the information about
    the units belonging to the subset at each step of the forward search. <br>
    1st col = indexes of the units forming subset in the initial step <br>
    ... <br>
    last column = units forming subset in the final step (all units)</p>
  </li>
</ul>
<ul>
  <a name="zmw57dd0e69798"></a> 

  <table border="1" cellpadding="5" cellspacing="0" class="note" summary="Note">
    <tbody>
      <tr>
        <td><p><b>Note</b>   <tt>FSMmmd</tt> is nothing but a simplified
          version of function <tt>FSMeda</tt>. </p>
        </td>
      </tr>
    </tbody>
  </table>
</ul>

<p></p>

<p><tt>[mmd,Un,BB] =
FSMmmd(Y,bsb,<i><tt>param1</tt></i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)</tt>
specifies one or more of the name/value pairs described in the following
table.</p>

<table border="2" cellpadding="4" cellspacing="0" class="body">
  <colgroup><col width="21%">
    <col width="79%">
  </colgroup>
  <thead>
    <tr valign="top">
      <th bgcolor="#B2B2B2">Parameter</th>
      <th bgcolor="#B2B2B2">Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td bgcolor="#F2F2F2" style="height: 54px"><tt>'init'</tt></td>
      <td bgcolor="#F2F2F2" style="height: 54px"><p>scalar, which specifies the
        point where to initialize the search and start monitoring required
        diagnostics. Notice that if bsb is supplied init&gt;=length(bsb). if
        init is not specified it will be set equal to floor(n*0.6).</p>
      </td>
    </tr>
    <tr valign="top">
      <td bgcolor="#F2F2F2" style="height: 75px"><tt>'msg'</tt></td>
      <td bgcolor="#F2F2F2" style="height: 75px"><p>Scalar which controls
        whether to display or not messages about great interchange on the
        screen<br>
        If msg=1 (default) messages are displayed on the screen else no message
        is displayed on the screen.</p>
      </td>
    </tr>
    <tr valign="top">
      <td bgcolor="#F2F2F2"><tt>'plots'</tt></td>
      <td bgcolor="#F2F2F2"><p>If plots=1 a plot of minimum Mahalanobis
        distance appears on the screen with 1%, 50% and 99% confidence bands
        else (default) no plot is shown.</p>
      </td>
    </tr>
  </tbody>
</table>

<p></p>
<a name="bq9x7hn"></a><a name="bq5gf2y"></a> 

<h3>Example 1</h3>
In this example we show the monitoring of the minimum Mahalanobis distance for
a random subset of 200 observations with three contaminated observations. The
Forward Search is run starting from an initial subset composed by the 4
observations which fell the smallest number of times outside the robust
bivariate ellipses and with the lowest Mahalanobis Distance. 
<pre class="programlisting">    
n=200;
v=3;
m0=4;
randn('state',123456);
Y=randn(n,v);
%Contaminated data
Ycont=Y;
Ycont(1:5,:)=Ycont(1:5,:)+3;
[fre]=unibiv(Y);
%create an initial subset with the 4 observations, which fell the smallest
%number of times outside the robust bivariate ellipses, and with the 
%lowest Mahalanobis Distance.
fre=sortrows(fre,[3 4]);
bs=fre(1:m0,1);
%Run the fast monitoring of the minimum Mahalanobis distance
tic;
[mmd,Un,BB]=FSMmmd(Ycont,bs,'plots',1);
toc
%Now run the traditional monitoring
tic;
[mmd,Un,BB]=FSMmmdeasy(Ycont,bs,'plots',1);
toc

% both functions produce the same output, but FSMmmd is much faster. This is the tic-toc output for the two functions, obtained on an old portable with a 2.8GHz CPU. 
&gt; Elapsed time is 0.093227 seconds.
&gt; Elapsed time is 7.484375 seconds.

%To appreciate even more the difference, it is instructive to run the functions also with the 'plots' option set to 0 (i.e. no graphic output, particularily expensive, is produced). </pre>
<img src="plots/fsmmmd.gif"> 

<p><br>
</p>

<p> </p>

<h3>See Also</h3>

<p><a href="fsm.html"><tt>FSM</tt></a>, <a
href="fsmeda.html"><tt>FSMeda</tt></a>, <a
href="fsminvmmd.html"><tt>FSMinvmmd</tt></a></p>

<table border="0" cellpadding="0" cellspacing="0" class="feedbacklinkbot"
width="100%">
  <tbody>
    <tr>
      <td> </td>
      <td align="right"><a
        href="mailto:toolboxFS@unipr.it?subject=feedback">Provide feedback on
        FSDA toolbox</a> </td>
    </tr>
  </tbody>
</table>

<p></p>

<table border="0" cellpadding="0" cellspacing="0" class="nav"
summary="Navigation aid" width="100%">
  <tbody>
    <tr valign="top">
      <td align="left" width="20"><a href="fsmmmd.html"><img align="bottom"
        alt="FSMfan" border="0" src="images_help/b_prev.gif"></a> </td>
      <td align="left">fsmmmd.html</td>
      <td> </td>
      <td align="right">fsmtra.html</td>
      <td align="right" width="20"><a href="fsmtra.html"><img align="bottom"
        alt="levfwdplot " border="0" src="images_help/b_next.gif"></a></td>
    </tr>
  </tbody>
</table>
<script type="text/javascript" language="javaScript">
document.write(barra);</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->
</body>
</html>
