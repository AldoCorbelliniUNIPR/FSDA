<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">


<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>FSMfan :: Functions (Flexible Statistics Data Analysis Toolbox&trade;)</title>
<link href="docstyle.css" rel="stylesheet" type="text/css">
<meta content="refpage" name="chunktype">

<script  type="text/javascript" language="javaScript" src="bottom.js"></script>

</head>


<body>

<a name="top_of_page"></a>
<p style="font-size: 1px;">&nbsp;</p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr>
		<td valign="baseline"><b>Flexible Statistics Data Analysis Toolbox&trade;</b></td>
		<td align="right" valign="baseline"><a href="fsmenvmmd.html">
		<img align="bottom" alt="fsmenvmmd" border="0" src="images_help/b_prev.gif"></a>&nbsp;&nbsp;
		<a href="fsminvmmd.html">
		<img align="bottom" alt="fsmmmd" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" class="feedbacklinktop" width="100%">
	<tr>
		<td>&nbsp;</td>
		<td align="right">
		<a href="mailto:toolboxFS@unipr.it?subject=feedback">Provide feedback on FSDA toolbox</a>
</td>
	</tr>
</table>
<a name="minplot-1"></a><a class="indexterm" name="zmw57dd0e69698"></a>
<h1 class="reftitle">FSMfan</h1>
<p class="purpose">Confirmatory lrt of a suggested transformation (multivariate fan plot). </p>
<h2>Syntax </h2>
<p class="synopsis"><tt>out=FSMfan(Y,la0)<br>out=FSMfan(Y,la0,<i><tt>param1</tt></i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)<br>
</tt></p>
<a name="minplot-2"></a>
<h2>Description</h2>
<p><tt>FSMfan(out,la0)</tt> produces a confirmatory signed square root likelihood ratio tests of a suggested transformation for specified variables around a series of values of lambda0. </p>
<p><tt>Y</tt> is a matrix of size <i>n</i>-by-<i>v</i> containing (in the columns) 
the variables of the dataset<br>
<p><tt>la0</tt> is a vector of length v=size(Y,2) specifying a reasonable set
              of transformations for the columns of the multivariate data set.
</p>
<p><tt>[out] = FSMfan(Y,la0)</tt> returns the following information

</p>
<ul type="disc">
	<li><tt>out</tt> &minus; A structure of additional statistics with the following fields.
	
	<ul type="circle">
		<li>
		<p><tt>LRT</tt> &minus; cell of length <tt>ColtoComp</tt>. Each element of the cell contains the
              a matrix of size <tt>n-init+1</tt> by <tt>length(laAround)+1</tt> which
              contains the monitoring of (signed square root) likelihood
              ratio for testing H0:\lambda_j=la0_j when all the other
              variables are transformed as specified in vector la0.<br>
              More precisely each
              matrix of size n-init+1 x length(laAround)+1 presents the
              following structure <br>
              1st col = fwd search index (from init to n)<br>
              2nd col = value of the (signed sqrt) likelihood ratio for
              testing laj=laAround(1)<br>
              ...<br>
              length(laAround)+1 col = value of the (signed sqrt) likelihood ratio for
              testing laj=laAround(end)<br>
             </p>
		</li>
		
		<li>
		<p><tt>Exflag</tt> &minus; cell of length <tt>ColtoComp</tt>. Each element of the cell contains the
              a matrix of size <tt>n-init+1</tt> by <tt>length(laAround)+1</tt> which
              contains the monitoring of the integer which identifies the reason why the 
              algorithm terminated. Each element of Exflag contains a correspondence with each element 
              of LRT.&nbsp; For example Exflag{i}(:,[1 4]) informs us about the reason why the maximization terminated 
              for ColtoComp(i) and laAround{3}. 
             </p>
		</li>
		

		
		<li>
		<p><tt>Un</tt> &minus; cell of length <tt>ColtoComp</tt>. Each element of the cell contains 
              a (sub)cell of size length(laAround). Each element of this (sub)cell
              contains a  n-init+1 x 11 matrix which informs about the order of entry of the units
              For example Unj=Un{i}{j} refers to ColtoComp(i) and laAround(j) 
              Unj is a (n-init) x 11 matrix which contains the unit(s)
              included in the subset at each step of the fwd search
              REMARK: in every step the new subset is compared with the
              old subset. Un contains the unit(s) present in the new
              subset but not in the old one Unj(1,2) for example contains
              the unit included in step init+1 Unj(end,2) contains the
              units included in the final step of the search</p>
		</li>
	</ul>
	<ul>
		
		<a name="zmw57dd0e69798"></a>
		
	</ul>
	</li>
</ul>
<p><tt>[out] = FSMfan(<i>Y,param1</i>,<i>val1</i>,<i>param2</i>,<i>val2</i>,...)</tt> 
specifies one or more of the name/value pairs described in the following table.</p>
<table border="2" cellpadding="4" cellspacing="0" class="body">
	<colgroup>
		<col width="21%"><col width="79%">
	</colgroup>
	<thead>
		<tr valign="top">
			<th bgcolor="#B2B2B2">Parameter</th>
			<th bgcolor="#B2B2B2">Value</th>
		</tr>
	</thead>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;rf&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Confidence level for bivariate ellipses 
		(default is 0.95). This option is useful only if crit=&#39;biv&#39;.</td>
			</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;init&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>scalar which specifies the point where to start monitoring
              required diagnostics. Note that if init is not specified it will
              be set equal to floor(n*0.6).</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;ColToComp&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>k x 1 integer vector specifying the
              variables for which likelihood ratio tests have to be produced. For
              example, if ColToComp = [2 4], the signed likelihood ratio tests
              are produced for the second and the fourth column of matrix Y. If
              col.to.compare = '' then all variables (columns of matrix Y) are
              considered.</td>
			</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;laAround&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p> r x 1 vector specifying for which values
              of lambda to compute the likelihood ratio test. If this argument is
              omitted, the function produces for each variable specified in
              ColToComp the likelihood ratio tests associated to the five most
              common values of lambda [-1, -0.5, 0, 0.5, 1]..</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;optmin&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>
		structure containing the options dealing with the
              maximization algorithm. Use optimset to set these options.
              Notice that the maximization algorithm which is used is
              
              
              <a href="matlab:web(['jar:file:///',matlabroot,'/help/toolbox/optim/help.jar!/ug/fminunc.html'],'-helpbrowser')">
<tt>fminunc</tt></a> if the
              optimization toolbox is installed otherwise
<a href="matlab:web(['jar:file:///',matlabroot,'/help/techdoc/help.jar!/ref/fminsearch.html'],'-helpbrowser')">
<tt>fminsearch</tt></a>
                
</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;speed&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>scalar. If speed=1 (default) the initial value at step m of
              the maximization procedure (fminunc or fminsearch) is the
              final value at step m-1 else it is la0.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;colnames&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>cell array of strings of length v containing the names of
              the variables of the dataset. If colnames is empty then the
              sequence 1:v is created to label the variables.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;signlr&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>scalar. If signlr = 1 (default) plots of signed square root
              likelihood ratios are produced, else likelihood ratios are
              produced.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;plotslrt&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>
		scalar or structure specifying whether it is necessary to
              plot the likelihood ratio test<br>
              Structure plotslrt may contain the following fields: <br>
              
   <tt>xlim</tt> = minimum and maximum on the x axis<br>


                  <tt>ylim</tt> = minimum and maximum on the y axis<br>

                  <tt>LineWidth</tt> = Line width of the trajectory of lrt of
                  transformation parameters<br>

                  <tt>conflev</tt> = vector which defines the confidence levels of
                  the horizontal line for the likelihood ratio test
                  (default is conflev=[0.99])<br>
                  
                        <tt>LineWidthEnv</tt> = Line width of the horizontal lines<br>
            
            <tt>Tag</tt> = tag of the plot (default is pl_lrt)<br>
            
                           
      
                       
             
                  </p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;msg&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p> scalar which controls whether to display or not messages
              about great interchange on the screen. <br>
If <tt>msg</tt>=1 (default) messages are displayed on the screen
              else no message is displayed on the screen<br></p>
		</td>
	</tr>
</table>
<p></p>

<p>&nbsp;</p>

<h3>See Also</h3>

<p><a href="resindexplot.html"><tt>resindexplot</tt></a>, <a href="resfwdplot.html"><tt>resfwdplot</tt></a>, <a href="fanplot.html"><tt>fanplot</tt></a>
</p>
<table border="0" cellpadding="0" cellspacing="0" class="feedbacklinkbot" width="100%">
	<tr>
		<td>&nbsp;</td>
		<td align="right">
		<a href="mailto:toolboxFS@unipr.it?subject=feedback">Provide feedback on FSDA toolbox</a>
</td>
	</tr>
</table>

<p></p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr valign="top">
		<td align="left" width="20"><a href="fsmenvmmd.html">
		<img align="bottom" alt="fsmenvmmd" border="0" src="images_help/b_prev.gif"></a>
		</td>
		<td align="left">fsmenvmmd.html</td>
		<td>&nbsp;</td>
		<td align="right">fsminvmmd.html</td>
		<td align="right" width="20"><a href="fsminvmmd.html">
		<img align="bottom" alt="fsmmmd" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<script type ="text/javascript" language="javaScript">
document.write(barra);
</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->

</body>

</html>
