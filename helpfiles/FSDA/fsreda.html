<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<!--FScategory:Robust Regression Analysis and transformations-->


<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>FSReda :: Functions (Flexible Statistics Data Analysis Toolbox&trade;)</title>
<link href="docstyle.css" rel="stylesheet" type="text/css">
<meta content="refpage" name="chunktype">


<script  type="text/javascript" language="javaScript" src="bottom.js"></script>

</head>


<body>

<a name="top_of_page"></a>
<p style="font-size: 1px;">&nbsp;</p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr>
		<td valign="baseline"><b>Flexible Statistics Data Analysis Toolbox&trade;</b></td>
		<td align="right" valign="baseline"><a href="fsrcp.html">
		<img align="bottom" alt="FSRcp" border="0" src="images_help/b_prev.gif"></a>&nbsp;&nbsp;
		<a href="fsrenvmdr.html">
		<img align="bottom" alt="FSRenvmdr" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" class="feedbacklinktop" width="100%">
	<tr>
		<td>&nbsp;</td>
		<td align="right">
		<a href="mailto:toolboxFS@unipr.it?subject=feedback">Provide feedback on FSDA toolbox</a>
</td>
	</tr>
</table>
<a name="bq24of9-1"></a><a class="indexterm" name="zmw57dd0e69698"></a>
<h1 class="reftitle">FSReda</h1>
<p class="purpose">Forward search in linear regression (FSR) with exploratory data 
analysis (eda) purposes </p>
<h2>Syntax </h2>
<p class="synopsis"><tt>[out] = FSReda(y,X,bsb)<br>[out] = FSReda(y,X,bsb,<i>param1</i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)<br>
</tt></p>
<a name="bq24of9-2"></a>
<h2>Description</h2>
<p><tt>[out] = FSReda(y,X,bsb)</tt> enables to monitor the evolution of residuals, parameters 
estimates and inferences as the subset size increases. In other words, this function 
stores the required quantities to present the results as “forward plots” which show 
the evolution of the quantities of interest as a function of subset size. Therefore, 
unlike other robust approaches, the forward search is a dynamic process that produces 
a sequence of estimates and related plots.&nbsp; </p>
<p>Cook distance, and the other diagnostic quantities, measure the effect of deletion 
of a single observation and so may be liable to masking when several outliers are 
present. The forward search overcomes this masking, with abrupt changes in parameter 
estimates indicating influential observations, which can be detected through the 
monitoring of a “forward version” of the Cook statistic .</p>
<p><tt>y</tt> is a vector of length <i>n</i> containing the response values, while
<tt>X</tt> is the <i>n</i>-by-<i>p-1</i> matrix which contains (in the columns) the 
values of <i>p-1</i> predictive terms. <tt>bsb</tt> is a vector containing the list 
of the units forming the initial subset. If <tt>bsb=0</tt> (default) then the procedure starts 
with p units randomly chosen else if bsb is not 0 the search will start with <tt>
m0=length(bsb)</tt></p>
<p><tt><a name="bq24of9-3"></a>[out] = FSReda(y,X,bsb)</tt> returns the following 
information </p>
<ul type="disc">
	<li><tt>out</tt> &minus; A structure of additional statistics with the following fields.
	<ul type="circle">
		<li>
		<p><tt>RES</tt> &minus; <tt>n</tt>-by-<tt>(n-init+1)</tt>  matrix containing the monitoring of scaled 
		residuals <br>1st row = residual for first unit <br>......<br>nth row = 
		residual for nth unit. </p>
		</li>
		<li>
		<p><tt>LEV</tt> &minus; <tt>n</tt>-by-<tt>(n-init+1)</tt> matrix containing the monitoring of leverage 
		<br>1st row = leverage for first unit <br>......<br>nth row = 
		leverage for nth unit. </p>
		</li>
		
		<li>
		<p><tt>BB</tt> &minus; <tt>n</tt>-by-<tt>(n-init+1)</tt> matrix containing the information about the units belonging
              to the subset at each step of the forward search. 
              <br>1st col = indexes of the units forming subset in the initial step 
              <br>... 
              <br>last column = units forming subset in the final step (all units)</p>
		</li>
		
		<li>
		<p><tt>mdr</tt> &minus;<tt>n</tt>-by-3 matrix which contains the monitoring of minimum
              deletion residual or (m+1)ordered residual  at each step of
              the forward search. 
              <br>1st col = fwd search index (from init to n-1) 
              <br>2nd col = minimum deletion residual 
              <br>3rd col = (m+1)-ordered residual</p>
		</li>
		
		
		<li>
		<p><tt>msr</tt> &minus; <tt>n</tt>-by-3 = matrix which contains the monitoring of
              maximum studentized residual or m-th ordered residual 
              <br>1st col = fwd search index (from init to n) 
              <br>2nd col = maximum studentized residual 
              <br>3rd col = (m)-ordered studentized residual</p>
		</li>
		
		<li>
		<p><tt>nor</tt> &minus; <tt>n</tt>-by-4 matrix containing the monitoring of
              normality test in each step of the forward search 
              <br>1st col = fwd search index (from init to n) 
              <br>2nd col = Asimmetry test
              <br>3rd col = Kurtosis test 
              <br>4th col = Normality test</p>
		</li>
		
		<li>
		<p><tt>Bols</tt> &minus; <tt>(n-init+1)</tt>-by-<tt>p</tt> matrix containing the monitoring of
              estimated beta coefficients in each step of the forward search</p>
		</li>

		
		<li>
		<p><tt>S2</tt> &minus; <tt>n</tt>-by-3 matrix containing the monitoring of S2 or R2
              in each step of the forward search 
              <br>1st col = fwd search index (from init to n) 
              <br>2nd col = monitoring of S2 
              <br>3rd col = monitoring of R2</p>
		</li>

		<li>
		<p><tt>Coo</tt> &minus; <tt>n</tt>-by-3 matrix containing the monitoring of Cook or
              modified Cook distance in each step of the forward search
              <br>1st col = fwd search index (from init to n) 
              <br>2nd col = monitoring of Cook distance 
              <br>3rd col = monitoring of modified Cook distance</p>
		</li>

		
		<li>
		<p><tt>Tols</tt> &minus; <tt>(n-init+1)</tt>-by-<tt>(p+1)</tt> matrix containing the monitoring of
              estimated t-statistics (as specified in option input 'tstat' 
              in each step of the forward search</p>
		</li>

		
		
		<li>
		<p><tt>Un</tt> &minus; <tt>n</tt>-by-11 matrix which contains the unit(s) included 
		in the subset at each step of the fwd search. <br>REMARK: in every step 
		the new subset is compared with the old subset. Un contains the unit(s) 
		present in the new subset but not in the old one.<br>Un(1,2) for example 
		contains the unit included in step init+1.<br>Un(end,2) contains the units 
		included in the final step of the search.</p>
		</li>
		
		<li>
		<p><tt>y</tt> &minus; A vector with n elements that contains the response
              variable which has been used</p>
		</li>

		<li>
		<p><tt>X</tt> &minus; Data matrix of explanatory variables 
              which has been used (it also contains the column of ones if
              input option intercept was missing or equal to 1)</p>
		</li>

	</ul>
	<ul>
		<a name="zmw57dd0e69798"></a>
		<table border="1" cellpadding="5" cellspacing="0" class="note" summary="Note">
			<tr width="90%">
				<td>
				<p><b>Note</b>&nbsp;&nbsp; <tt>FSReda</tt> automatically includes a 
				constant term in all models. Do not enter a column of 1s directly 
				into <tt>X</tt>.</p>
				</td>
			</tr>
		</table>
	</ul>
	</li>
</ul>
<p></p>
<p><tt>[out] = FSReda(y,X,bsb,<i><tt>param1</tt></i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)</tt> 
specifies one or more of the name/value pairs described in the following table.</p>
<table border="2" cellpadding="4" cellspacing="0" class="body">
	<colgroup>
		<col width="21%"><col width="79%">
	</colgroup>
	<thead>
		<tr valign="top">
			<th bgcolor="#B2B2B2">Parameter</th>
			<th bgcolor="#B2B2B2">Value</th>
		</tr>
	</thead>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;intercept&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>If 1, a model with constant term will be fitted (default) else no constant 
		term will be included.  </p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;init&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>scalar, which specifies the point where to initialize the search
              and start monitoring required diagnostics. Notice that if bsb
              is supplied init>=length(bsb). if init is not specified it will be set equal to
		<br><tt>p+1</tt>, if the sample size is smaller than 40; <br><tt>min(3*p+1,floor(0.5*(n+p+1)))</tt>, otherwise.</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;nocheck&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Scalar. If nocheck is equal to 1 no check is performed on
              matrix y and matrix X. Notice that y and X are left
              unchanged. In other words the additional column of ones for
              the intercept is not added. As default nocheck=0. The
              controls on h, alpha and nsamp still remain</p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;tstat&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Character string which specifies the kind of t-statistics which have to be monitored.
		<tt>tstat = 'trad'</tt> implies monitoring of traditional t
              statistics (out.Tols). In this case the estimate of 
		σ<sup>2</sup> at step <tt>m</tt>
              is based on s<sup>2</sup><sub>m</sub> (notice that <tt>s<sup>2</sup><sub>m</sub><<σ<sup>2</sup></tt> when <tt>m/n</tt> is
              small). <tt>tstat = 'resc'</tt> (default) implies monitoring of
              rescaled <tt>t</tt> statistics In this scale the estimate of
              σ<sup>2</sup> at step <tt>m</tt> is based on <tt>s<sup>2</sup><sub>m</sub> / 
              var_truncnorm(m/n)</tt>
              where <tt>var_truncnorm(m/n)</tt> is the variance of the truncated
              normal distribution.</p>
		</td>
	</tr>
	</table>
<p></p>
<h2>Examples</h2>
In this example we generate an artificial dataset 
with 100 observations and 8 explanatory variables.
The purpose is to train our eyes to the forward plots 
when no outlier is present in the data. Then we contaminate
our data and see our the forward plots react to contamination.
The same data are used in <a href="resindexplot.html">resindexplot</a>.
<pre class="programlisting">
% Generate an artificial dataset
n=100;
p=8;
state=1;
randn('state', state);
X=randn(n,p);
y=randn(n,1);
% Run the forward search with Exploratory Data Analysis purposes
% LMS using 10000 subsamples
[outLXS]=LXS(y,X,'nsamp',10000);
% Forward Search
[out]=FSReda(y,X,outLXS.bs);
</pre>
<strong>Typical patterns of forward plots with uncontaminated data.
</strong><p>
The monitoring residuals plot when no outlier is present and there is no leverage unit, 
should show no apparent pattern in the residuals along the search. 
</p>

<pre class="programlisting">
resfwdplot(out);
</pre>

<img alt="" src="plots/fsreda1.gif">
<p></p>
<p>The minimum deletion residual (apart from some isolated exceedances to 
the threshold in the central part of the search) should 
be contained in the 99% confidence bands
</p>
<pre class="programlisting">
mdrplot(out);
</pre>
<img alt="" src="plots/fsreda2.gif">
<p></p>
<p>The normality test should be inside the asymptotic 
confidence bands based on the chi^2 distribution </p>
<pre class="programlisting">
figure;
lwdenv=2;
xlimx=[10 100];
subplot(2,2,1);
plot(out.nor(:,1),out.nor(:,2));
title('Asimmetry test');
xlim(xlimx);
quant=chi2inv(0.99,1);
v=axis;
line([v(1),v(2)],[quant,quant],'color','r','LineWidth',lwdenv);

subplot(2,2,2)
plot(out.nor(:,1),out.nor(:,3))
title('Kurtosis test');
xlim(xlimx);
v=axis;
line([v(1),v(2)],[quant,quant],'color','r','LineWidth',lwdenv);

subplot(2,2,3:4)
plot(out.nor(:,1),out.nor(:,4));
xlim(xlimx);
quant=chi2inv(0.99,2);
v=axis;
line([v(1),v(2)],[quant,quant],'color','r','LineWidth',lwdenv);

title('Normality test');
xlabel('Subset size m');
</pre>

<img alt="" src="plots/fsreda3.gif">
<p></p>
<p>The R2 and the S2 should respectively show an increasing and 
decreasing pattern without significant jumps.</p>

<pre class="programlisting">
figure;
subplot(1,2,1)
plot(out.S2(:,1),out.S2(:,2))
xlabel('Subset size m');
ylabel('S2');
subplot(1,2,2)
plot(out.S2(:,1),out.S2(:,3))
xlabel('Subset size m');
ylabel('R2');
</pre>



<img alt="" src="plots/fsreda4.gif">
<p></p>

<p>Now, let us see what happens to the previous forward plots when some 
outliers are present. The contamination is associated with the first 10 units 
by adding to all dimensions a level shift of 5.
</p>
<pre class="programlisting">
y(1:10)=y(1:10)+5;
</pre>


<strong>Typical pattern of forward plots with a cluster of contaminated data.
</strong><p>
<p>
The monitoring residuals plot shows a set of positive residuals which starting 
from the central part of the search tend to have a residual much 
larger than that of the other units. 
</p>
<img alt="" src="plots/fsreda5.gif">
<p></p>
The minimum deletion residual from m=90 starts going above the 99% threshold.
<p><img alt="" src="plots/fsreda6.gif"></p>

<p>The curve which monitors the normality test shows a sudden big increase with the outliers are included</p>

<img src="plots/fsreda9.gif">
<h3>See Also</h3>

<p><a href="fsr.html"><tt>FSR</tt></a></p>
<table border="0" cellpadding="0" cellspacing="0" class="feedbacklinkbot" width="100%">
	<tr>
		<td>&nbsp;</td>
		<td align="right">
		<a href="mailto:toolboxFS@unipr.it?subject=feedback">Provide feedback on FSDA toolbox</a>
</td>
	</tr>
</table>
<p></p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr valign="top">
		<td align="left" width="20"><a href="fsrcp.html">
		<img align="bottom" alt="FSRcp" border="0" src="images_help/b_prev.gif"></a>
		</td>
		<td align="left">fsrcp.html</td>
		<td>&nbsp;</td>
		<td align="right">fsrenvmdr.html</td>
		<td align="right" width="20"><a href="fsrenvmdr.html">
		<img align="bottom" alt="FSRenvmdr" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<script type ="text/javascript" language="javaScript">
document.write(barra);
</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->

</body>

</html>
