<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<!--FScategory:Dynamic Statistical Visualization-->

<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>mdrplot :: Functions (Flexible Statistics Data Analysis Toolbox&trade;)</title>
<link href="docstyle.css" rel="stylesheet" type="text/css">
<meta content="refpage" name="chunktype">

<style type="text/css">
.style1 {
	vertical-align: middle;
}
</style>

<script  type="text/javascript" language="javaScript" src="bottom.js"></script>

</head>


<body>

<a name="top_of_page"></a>
<p style="font-size: 1px;">&nbsp;</p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr>
		<td valign="baseline"><b>Flexible Statistics Data Analysis Toolbox&trade;</b></td>
		<td align="right" valign="baseline"><a href="mcd.html">
		<img align="bottom" alt="malfwdplot" border="0" src="images_help/b_prev.gif"></a>&nbsp;&nbsp;
		<a href="minscale.html">
		<img align="bottom" alt="olsline" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" class="feedbacklinktop" width="100%">
	<tr>
		<td>&nbsp;</td>
		<td align="right">
		<a href="mailto:toolboxFS@unipr.it?subject=feedback">Provide feedback on FSDA toolbox</a>
</td>
	</tr>
</table>
<a name="minplot-1"></a><a class="indexterm" name="zmw57dd0e69698"></a>
<h1 class="reftitle">mdrplot</h1>
<p class="purpose">Plot of minimum deletion 
residual among the units which do not belong to the subset in each step of the forward 
search. </p>
<h2>Syntax </h2>
<p class="synopsis"><tt>mdrplot(out)<br>mdrplot(out,<i><tt>param1</tt></i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)<br>
</tt></p>
<a name="minplot-2"></a>
<h2>Description</h2>
<p><tt>mdrplot(out)</tt> plots the trajectory of minimum deletion residual.
At step m of the forward procedure the deletion residual are calculated for the n&minus;m observations 
not in <img alt="" height="43" src="plots/img89.gif" width="66" class="style1"> 
as follows. </p>
<p><img alt="" src="plots/img82.gif"> </p>
<p>The notation 
<img alt="" height="21" src="plots/img85.gif" width="59" class="style1"> serves 
as a reminder that the leverage of each observation depends on 
<img alt="" height="43" src="plots/img89.gif" width="66">. At the start of the 
search we have only p observations, each of which has leverage one
<img alt="" height="43" src="plots/img89.gif" width="66" class="style1">. Let the observation nearest 
to those constituting be i<i><sub>min</sub></i> where. </p>
<p><img src="plots/wp3nets4.gif"></p>
<p>the observation with the minimum absolute deletion residual among those not in
<img alt="" height="43" src="plots/img89.gif" width="66" class="style1">. If observation imin is 
an outlier, so will be all other observations not in
<img alt="" height="43" src="plots/img89.gif" width="66" class="style1">. To test whether observation
<em>i</em><sub>min</sub> is an outlier we use the absolute value of the minimum 
deletion residual</p>
<p><img src="plots/wpdpkocs.gif"></p>
<p><tt><a name="minplot-3"></a>mdrplot(out)</tt> needs as input the following information
</p>
<ul type="disc">
	<li><tt>out</tt> &minus; A structure containing the following fields.
	<ul type="circle">
		<li>
		<p><tt>mdr</tt> &minus; a matrix containing the monitoring of minimum deletion 
		residual in each step of the forward search. The first column of mdr must 
		contain the fwd search index </p>
		</li>
		
		
		    <li>          <tt>Un</tt> = matrix containing the order of entry of each unit
              (necessary if <tt>datatooltip</tt> is true or databrush is not empty)
              </li>
            
              <li>
              <tt>y</tt> &minus; a vector containing the response (necessary only if
              option <tt>databrush</tt> is not empty)
              </li>
              <li><tt>X</tt> &minus; a matrix containing the explanatory variables
              (necessary only if option databrush is not empty)
              </li>
              <li>
              <tt>
              Bols &minus; (n-init+1) x (p+1)</tt>   matrix containing the monitoring of
              estimated beta coefficients in each step of the forward search
              (necessary only if option <tt>databrush</tt> is not empty and
              suboption <tt>lineadd</tt> is not empty
</li>
		
		
	</ul>
	</li>
</ul>
<p></p>
<p><tt>mdrplot(out,<i><tt>param1</tt></i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)</tt> 
specifies one or more of the name/value pairs described in the following table.</p>
<table border="2" cellpadding="4" cellspacing="0" class="body">
	<colgroup>
		<col width="21%"><col width="79%">
	</colgroup>
	<thead>
		<tr valign="top">
			<th bgcolor="#B2B2B2">Parameter</th>
			<th bgcolor="#B2B2B2">Value</th>
		</tr>
	</thead>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;quant&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Vector containing quantiles for which envelopes have to be computed. 
		The default is to produce 1%, 50% and 99% envelopes. In other words the 
		default is quant=[0.01;0.5;0.99];</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;exact&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>Scalar, if it is equal to 1 the calculation of the quantiles of the T 
		and F distribution is based on functions finv and tinv from the Matlab statistics 
		toolbox, otherwise the calculations of the former quantiles is based on 
		functions invcdff and invcdft. The solution has a tolerance of 1e-8 (change 
		variable tol in files invcdff.m and invcdft.m if required. Remark: the use 
		of functions tinv and finv is more precise but requires more time. The default 
		value of exact is 0 (approximate solution).</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;sign&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>Scalar. If it is equal 1 (default) we distinguish steps for which minimum 
		deletion residual was associated with positive or negative value of the 
		residual. Steps associated with positive values of mdr are plotted in black, 
		while other steps are plotted in red</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;mplus1&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>Scalar, which specifies if it is necessary to plot the curve associated 
		with (m+1)th order statistic</p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;envm&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>Scalar which specifies the size of the sample which is used to superimpose 
		the envelope. The default is to add an envelope based on all the observations 
		(size n envelope).</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;xlimx&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>Vector with two elements controlling minimum and maximum on the x axis. 
		Default value is mdr(1,1)-3 and mdr(end,1)*1.1.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;ylimy&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>Vector with two elements controlling minimum and maximum on the x axis. 
		Default value is min(mdr(:,2)) and max(mdr(:,2))*1.1;</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;lwd&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Scalar which controls line width of the curves which contain the mdr. Default value is <tt>width=2</tt>. </p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;lwdenv&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>Scalar which controls the width of the lines associated with the envelopes. 
		Default is <tt>lwdenv=1</tt></p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;FontSize&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>Scalar which controls the font size of the labels of the axes. Default 
		value is 12.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;SizeAxesNum&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>Scalar which controls the size of the numbers of the axes. Default value 
		is 10.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;titl&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p> A label for the title (default: '')</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;labx&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p> A label for the x-axis (default: 'Subset size m')</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;laby&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p> A label for the y-axis (default: 'Minimum deletion residual') </p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;tag&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>String which identifies the handle of the plot which is about to be created. 
		The default is to use tag &#39;pl_mdr&#39;.  
		Notice that if the program finds a plot which has a tag equal to the one 
		specified by the user, then the output of the new plot overwrites the existing 
		one in the same window else a new window is created</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;datatooltip&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>Empty value or structure. The default is datatooltip=&#39;&#39; If datatooltip 
		is not empty the user can use the mouse in order to have information about 
		the unit selected, the step in which the unit enters the search and the 
		associated label If datatooltip is a structure, it is possible to control 
		the aspect of the data cursor (see function datacursormode for more details 
		or the examples below). The default options of the structure are DisplayStyle=&#39;Window&#39; 
		and SnapToDataVertex=&#39;on&#39;</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;label&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		  Cell containing the labels of the units (optional
              argument used when <tt>datatooltip=1</tt>. If this field is not
              present labels row1, ..., rown will be automatically
              created and included in the pop up <tt>datatooltip</tt> window)
              </td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;databrush&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>The core of this option is <tt>selectdataFS</tt>, a function used by 
		all graphic tools of the FSDA toolbox. A separate 
		common page details all <a href="databrushoption.html"><tt>databrush</tt> options</a>. </p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;nameX&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>cell array of strings of length <em>p</em> containing the labels
                  of the variables of the regression dataset. If it is empty
                	(default) the sequence <em>X</em><sub>1</sub>, ..., <em>X</em><sub>p</sub> will be created
                  automatically..</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;namey&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		character containing the label of the response.</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;lwd&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		Scalar which controls line width of the curve which contains the mdr. Default line width=2. 
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;FontSize&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		Scalar which controls the font size of the labels of the axes. Default 
		value is 12.</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;SizeAxesNum&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		Scalar which controls the size of the numbers of the axes. Default value 
		is 10.</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;titl&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		A label for the title (default: &#39;&#39;).</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;labx&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		A label for the x-axis (default: &#39;Subset size m&#39;)</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;laby&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		A label for the y-axis (default: &#39;Minimum deletion residual&#39;).</td>
	</tr>
</table>
<p></p>
<a name="bq9x7hn"></a><a name="bq5gf2y"></a>
<h3>Examples</h3>

<h3>Example 1</h3>
<p>
In this first example we use the same set of simulated data in web page 
<a href="resindexplot.html">resindexplot</a> 
in order to compare the output which comes out from the mdrplot and that which derives 
from the plot of robust residuals.
<pre class="programlisting">
n=100;
p=10;
state=1;

mtstream = RandStream('shr3cong','Seed',state);
RandStream.setDefaultStream(mtstream);
defaultStream = RandStream.getDefaultStream();
reset(defaultStream)

% Remark if you run this example with a version of MATLAB older than 7.9
% you have to comment the previous four lines and uncomment the following
% line
% randn('state', state);

X=randn(n,p);
y=randn(n,1);
y(1:30)=y(1:30)+5;


[out]=LXS(y,X);
[out]=FSReda(y,X,out.bs);
% The plot of minimum deletion residual shows a peak out of the envelope in
% the central part of the search
mdrplot(out)
</pre>
The monitoring of the minimum deletion residual clearly shows that the sample is not homogeneous. 
Clearly the peak out the 99% upper envelope during the central part of the search 
shows that there is a subset of about 70 homogeneous units.<p>&nbsp;</p>
&nbsp;<img src="plots/minplot1.gif">
</p>


<h3>Example 2</h3>
<p>
In this example we show the plot of minimum deletion for the hospital dataset.
These data have been introduced by Neter et al. (1996, p. 334) and refer to
the logged survival time of 54 patients
undergoing liver surgery, together with four potential explanatory variables. On p. 437
another 54 observations are introduced to check the model fitted to the first 54. Their
comparison suggests there is no systematic difference between the two sets.

<pre class="programlisting">
load('hospital.txt');
y1=hospital(:,5);
X=hospital(:,1:4);
[out]=LXS(y1,X,'nsamp',10000,'lms',0);
[out1]=FSReda(y1,X,out.bs);
% The plot of minimum deletion residual shows a peak out of the envelope in
% the central part of the search
mdrplot(out1,'quant',[0.01 0.5 0.99 0.9999 0.99999],'ylimy',[1 5],'lwdenv',2,'xlimx',[10 110]);
</pre>
<p>The extreme value of the minimum deletion residual at the centre of the plot is
caused by the entry of observations from one group followed
by the entry of several observations from the other group. More in detail,
the maximum value of the statistic is at <em>m</em> = 55. The units that enter after 
<em>m</em> = 57 nearly all come from the group of confirmatory
observations, an indication that this second group of observations differs systematically
from the original 54 units.
</p>
<img src="plots/minplothosp.gif">
<p>
Also in this case it is possible to compare the output of the mdrplot with that which
comes from the plot of robust residuals (see page <a href="resindexplot.html">resindexplot</a>).
</p>

<h3>See Also</h3>

<p><a href="resindexplot.html"><tt>resindexplot</tt></a>, <a href="mmdplot.html"><tt>mmdplot</tt></a>, <a href="resfwdplot.html"><tt>resfwdplot</tt></a>
</p>
<table border="0" cellpadding="0" cellspacing="0" class="feedbacklinkbot" width="100%">
	<tr>
		<td>&nbsp;</td>
		<td align="right">
		<a href="mailto:toolboxFS@unipr.it?subject=feedback">Provide feedback on FSDA toolbox</a>
</td>
	</tr>
</table>

<p></p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr valign="top">
		<td align="left" width="20"><a href="mcd.html">
		<img align="bottom" alt="malfwdplot" border="0" src="images_help/b_prev.gif"></a>
		</td>
		<td align="left">mcd.html</td>
		<td>&nbsp;</td>
		<td align="right">minscale.html</td>
		<td align="right" width="20"><a href="minscale.html">
		<img align="bottom" alt="olsline" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<script type ="text/javascript" language="javaScript">
document.write(barra);
</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->

</body>

</html>
