<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">


<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>LTS and LMS:: Robust Regression Analysis (Flexible Statistics Data Analysis Toolbox&trade;)</title>
<link href="docstyle.css" rel="stylesheet" type="text/css">
<meta content="refpage" name="chunktype">

<meta content="DocBook XSL Stylesheets V1.52.2" name="generator">
<meta content="Visualizing relationships among variables" name="description">
<meta content="text/javascript" http-equiv="Content-Script-Type">
<script  type="text/javascript" language="javaScript" src="bottom.js"></script>

</head>


<body>

<a name="top_of_page"></a>
<p style="font-size: 1px;">&nbsp;</p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr>
		<td valign="baseline"><b>Flexible Statistics Data Analysis Toolbox&trade;</b></td>
		<td align="right" valign="baseline"><a href="regression_intro.html">
		<img align="bottom" alt="Introduction to Robust Estimators in Linear Regression" border="0" src="images_help/b_prev.gif"></a>&nbsp;&nbsp;
		<a href="regression_fsreda.html">
		<img align="bottom" alt="Box Plots" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<a name="bqvsgfl-1"></a>
<h2 id="bqvsgfl-1" class="title">Least trimmed squares (LTS) and Least median 
of squares (LMS)</h2>
<a class="indexterm" name="zmw57dd0e2698"></a>
<p></p>
<p>The LTS regression estimators tries to find the estimate of 
β which minimizes the sum of the <em>h</em> smallest squared 
residuals, where h must be at least half the number of observations. 

<br>The LMS regression estimators tries to find the estimate of 
β which minimizes a quantile (generally the median) of squared 
residuals. 

LTS belongs to the class of L-estimators, so is asymptotically normal and has the usual convergence rate of
<em>n</em><sup>-0.5</sup>.

On the other hand, it is possible to show that even if the LMS estimator has an 
asymptotic normal distribution has a slower convergence rate of
<em>n</em><sup>-1/3</sup>.

</p>
<p>In the analysis which follows we analyze the transformed fidelity data and we 
compare the residuals which come out from the different options of traditional robust 
estimators (reweighted or not reweighted, individual tests or simultaneous tests 
confidence bands). In order to have a stable pattern of residuals we chose to 
extract 30000 subsets.</p>
<pre class="programlisting">
% Load the 'loyalty cards data' 
load('loyalty.txt');
% define y and X
y=loyalty(:,4);
X=loyalty(:,1:3);
% transform y
y1=y.^(0.4);

% Define nominal confidence level
conflev=0.99;
% Define number of subsets 
nsamp=30000;
% Define the main title of the plots
titl='';

% LMS with no rewighting
[outLMS]=LXS(y1,X,'nsamp',nsamp,'conflev',conflev);
h1=subplot(2,2,1);
laby='Scaled LMS residuals'; 
resindexplot(outLMS.residuals,'h',h1,'title',titl,'laby',laby,'numlab','','conflev',conflev)

% LTS with no rewighting
[outLTS]=LXS(y1,X,'nsamp',nsamp,'conflev',conflev,'lms',0);
h2=subplot(2,2,2);
laby='Scaled LTS residuals'; 
resindexplot(outLTS.residuals,'h',h2,'title',titl,'laby',laby,'numlab','','conflev',conflev);

% LMS with reweighting
[outLMSr]=LXS(y1,X,'nsamp',nsamp,'conflev',conflev,'rew',1);
h3=subplot(2,2,3);
laby='Scaled reweighted LMS residuals'; 
resindexplot(outLMSr.residuals,'h',h3,'title',titl,'laby',laby,'numlab','','conflev',conflev)

% LTS with reweighting
[outLTSr]=LXS(y1,X,'nsamp',nsamp,'conflev',conflev,'rew',1,'lms',0);
h4=subplot(2,2,4);
laby='Scaled reweighted LTS residuals'; 
resindexplot(outLTSr.residuals,'h',h4,'title',titl,'laby',laby,'numlab','','conflev',conflev);
</pre>
<p>
The picture below gives the residuals which appear if we use LMS or LTS combined 
with the option reweighting and we use a nominal 99% confidence interval 
individual test. Notice that using standard individual test procedure with 
nominal size 
α, in 
each dataset we expect to declare as outliers α% of the values. </p>
<p>
<img alt="Comparison of robust residuals" src="plots/residualscomp.jpg" height="727" width="1336">&nbsp;</p>
<p>If we use a simultaneous confidence interval,
that is if we specify <tt>conflev</tt> using the following code
</p>
<pre class="programlisting">
conflev=1-0.01/length(y);
</pre>
these are the plots that we get. Notice that using a simultaneous test procedure with size 
α we expect to find at least one outlier in α% of the 
datasets.
<p>
<img alt="Comparison of robust residuals" src="plots/residualscompS.jpg" height="727" width="1336">&nbsp;</p>
<p>

<p>The structure of the residuals which comes from the use of LMS seems to be 
quite different from the one which comes out from LTS. If we use a simultaneous 
test procedure no unit is declared as outliers using LMS. The units declared as 
outliers in LTS depend on the fact that we use or not the option reweighting.
In addition, it is not clear if the units declared as outliers form a group or 
which they exert on the fitted regression model.<p></p>

<h3>See Also</h3>

<p><a href="fsreda.html"><tt>FSReda</tt></a>, <a href="fsr.html"><tt>FSR</tt></a>,
<a href="lxs.html"><tt>LXS</tt></a></p>


<p></p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr valign="top">
		<td align="left" width="20"><a href="regression_intro.html">
		<img align="bottom" alt="Introduction" border="0" src="images_help/b_prev.gif"></a>
		</td>
		<td align="left">Introduction to robust estimators in linear regression</td>
		<td>&nbsp;</td>
		<td align="right">Robust Forward Linear Regression with exploratory purposes</td>
		<td align="right" width="20"><a href="regression_fsreda.html">
		<img align="bottom" alt="" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<script type ="text/javascript" language="javaScript">
document.write(barra);
</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->

</body>

</html>
