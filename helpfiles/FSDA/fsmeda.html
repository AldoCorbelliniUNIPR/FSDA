<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<!--FScategory:Robust multivariate analysis and transformations-->


<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>FSMeda :: Functions (Flexible Statistics Data Analysis Toolbox&trade;)</title>
<link href="docstyle.css" rel="stylesheet" type="text/css">
<meta content="refpage" name="chunktype">


<style type="text/css">
.style1 {
	text-align: left;
}
</style>


<script  type="text/javascript" language="javaScript" src="bottom.js"></script>

</head>


<body>

<a name="top_of_page"></a>
<p style="font-size: 1px;">&nbsp;</p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr>
		<td valign="baseline"><b>Flexible Statistics Data Analysis Toolbox&trade;</b></td>
		<td align="right" valign="baseline"><a href="fsmbonfbound.html">
		<img align="bottom" alt="FSM" border="0" src="images_help/b_prev.gif"></a>&nbsp;&nbsp;
		<a href="fsmenvmmd.html">
		<img align="bottom" alt="FSMenvmmd" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" class="feedbacklinktop" width="100%">
	<tr>
		<td>&nbsp;</td>
		<td align="right">
		<a href="mailto:toolboxFS@unipr.it?subject=feedback">Provide feedback on FSDA toolbox</a>
</td>
	</tr>
</table>
<a name="bq24of9-1"></a><a class="indexterm" name="zmw57dd0e69698"></a>
<h1 class="reftitle">FSMeda</h1>
<p class="purpose">Forward search in multivariate context (FSM) with exploratory data 
analysis (eda) purposes.</p>
<h2>Syntax </h2>
<p class="synopsis"><tt>[out] = FSMeda(Y,bsb)<br>[out] = FSMeda(Y,bsb,<i>param1</i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)<br>
</tt></p>
<a name="bq24of9-2"></a>
<h2>Description</h2>
<p><tt>[out] = FSMeda(Y,bsb)</tt> enables to monitor the evolution of 
distances, parameters 
estimates and inferences as the subset size increases. In other words, this function 
stores the required quantities to present the results as “forward plots” which show 
the evolution of the quantities of interest as a function of subset size. Therefore, 
unlike other robust approaches, the forward search is a dynamic process that produces 
a sequence of estimates and related plots.&nbsp; </p>
<p>Y is a matrix of
dimension <i>nxp</i> containing 
the <i>n</i> observations in the rows and the v variables 
in the columns. <tt>bsb</tt> is a vector containing the list 
of the units forming the initial subset. If <tt>bsb=0</tt> (default) then the procedure starts 
with v units randomly chosen else if bsb is not 0 the search will start with <tt>
m0=length(bsb).</tt></p>
<p><tt><a name="bq24of9-3"></a>[out] = FSMeda(Y,bsb)</tt> returns the following 
information </p>
<ul type="disc">
	<li><tt>out</tt> &minus; A structure of additional statistics with the following fields.
	<ul type="circle">
		<li>
		<p><tt>MAL</tt> &minus; <tt>n</tt>-by-<tt>(n-init+1)</tt> matrix 
		containing the monitoring of Mahalanobis distance<br>1st row = 
		distance for first unit <br>......<br>nth row = 
		distance for nth unit. </p>
		</li>
		
		<li>
		<p><tt>BB</tt> &minus; <tt>n</tt>-by-<tt>(n-init+1)</tt> matrix containing the information about the units belonging
              to the subset at each step of the forward search. 
              <br>1st col = indexes of the units forming subset in the initial step 
              <br>... 
              <br>last column = units forming subset in the final step (all units)</p>
		</li>
		
		<li>
		<p><tt>mmd</tt> &minus;<tt>n-init</tt>-by-3 matrix which contains the monitoring of minimum
              Mahalanobis distance or (m+1)ordered 
		MD  at each step of
              the forward search. 
              <br>1st col = fwd search index (from init to n-1) 
              <br>2nd col = minimum Mahalanobis distance<br>3rd col 
		= (m+1)-ordered MD</p>
		</li>
		
		
		<li>
		<p><tt>msr</tt> &minus; n-init+1-by-3 = matrix which contains the monitoring of
              maximum Mahalanobis distance or m-th 
		ordered MD 
              <br>1st col = fwd search index (from init to n) 
              <br>2nd col = maximum Mahalanobis distance 
              <br>3rd col = (m)-ordered Mahalanobis distance</p>
		</li>
		<li>
		<p><tt>gap</tt> &minus; n-init+1 
		x 3 = matrix which contains the monitoring of the gap (difference 
		between minimum MD outside subset and maximum 
		inside)<br>1st col = fwd search index (from init to n)<br>2nd col = min 
		MD - max MD<br>3rd col = (m+1)th ordered MD - mth ordered distance</p>
		</li>
		
		<li>
		<p><tt>mea</tt> &minus; (n-init+1) x (v+1) matrix 
		containing the monitoring of estimated of the means for each variable in 
		each step of the forward search</p>
		</li>
		
		<li>
		<p><tt>S2cov</tt> &minus; (n-init+1) x 
		(v*(v+1)/2+1) matrix containing the monitoring of the elements of the 
		covariance matrix in each step of the forward 
		search<br>1st col = fwd search index (from init to n)<br>2nd col = 
		monitoring of S(1,1)<br>&nbsp;....<br>3rd col = monitoring of S(v,v)</p>
		</li>

		
		<li>
		<p>detS &minus; (n-init+1) x (2) matrix 
		containing the monitoring of the determinant of the covariance matrix in 
		each step of the forward search</p>
		</li>

		
		
		<li>
		<p><tt>Un</tt> &minus; <tt>n</tt>-by-11 matrix which contains the unit(s) included 
		in the subset at each step of the fwd search. <br>REMARK: in every step 
		the new subset is compared with the old subset. Un contains the unit(s) 
		present in the new subset but not in the old one.<br>Un(1,2) for example 
		contains the unit included in step init+1.<br>Un(end,2) contains the units 
		included in the final step of the search.</p>
		</li>
		
		<li>
		<p>Y − Original data input matrix</p>
		</li>

	</ul>
	</li>
</ul>
<p><tt>[out] = FSMeda(Y,bsb,<i><tt>param1</tt></i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)</tt> 
specifies one or more of the name/value pairs described in the following table.</p>
<table border="2" cellpadding="4" cellspacing="0" class="body">
	<colgroup>
		<col width="21%"><col width="79%">
	</colgroup>
	<thead>
		<tr valign="top">
			<th bgcolor="#B2B2B2">Parameter</th>
			<th bgcolor="#B2B2B2">Value</th>
		</tr>
	</thead>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;init&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>scalar, which specifies the point where to initialize the search and 
		start monitoring required diagnostics. Notice that if bsb is supplied 
		init&gt;=length(bsb). If init is not specified it will be set equal to 
		floor(n*0.6).</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2">&#39;plots&#39;</td>
		<td bgcolor="#F2F2F2">
		<p>scalar. If plots=1, a plot of the monitoring of minMD among the units not belonging to the
		 subset is produced on the screen with 1, 50 and 99 
		% confidence bands, else (default) all plots are
		suppressed.</td>

		<p>&nbsp;</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2">&#39;msg&#39;</td>
		<td bgcolor="#F2F2F2">
		<p>
		scalar which controls whether to display or not messages about 
		great interchange on the screen.<br>If msg=1 (default) messages are displyed on the screen else no message is displayed on the screen.</p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2">&#39;scaled&#39;</td>
		<td bgcolor="#F2F2F2">
		<p>
		scalar. If scaled=1 scaled Mahalanobis distances are monitored 
		during the search</a></p>
		</td>
	</tr>
	</table>
<p></p>
<h2>Examples</h2>
In this example we generate an artificial dataset 
with 100 observations and 3 explanatory variables. 
We&nbsp;run FSMeda with an initial subset formed by the three observations with 
the lowest Mahalanobis distance, as follows:
<pre class="programlisting">
n=100;
v=3;
m0=3;
Y=randn(n,v);
% Contaminated data
Ycont=Y;
Ycont(1:5,:)=Ycont(1:5,:)+3;
[fre]=unibiv(Y);
%create an initial subset with the 3 observations with the lowest Mahalanobis Distance
fre=sortrows(fre,4);
bs=fre(1:m0,1);
[out]=FSMeda(Ycont,bs,'plots',1);</pre>

<img alt="" src="plots/fsmeda.gif">
<p></p>
<h3>See Also</h3>

<p><a href="fsm.html"><tt>FSM</tt></a></p>
<table border="0" cellpadding="0" cellspacing="0" class="feedbacklinkbot" width="100%">
	<tr>
		<td>&nbsp;</td>
		<td align="right">
		<a href="mailto:toolboxFS@unipr.it?subject=feedback">Provide feedback on FSDA toolbox</a>
</td>
	</tr>
</table>
<p></p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr valign="top">
		<td align="left" width="20"><a href="fsmbonfbound.html">
		<img align="bottom" alt="FSM" border="0" src="images_help/b_prev.gif"></a>
		</td>
		<td align="left">fsmbonfbound.html</td>
		<td>&nbsp;</td>
		<td align="right">fsmenvmmd.html</td>
		<td align="right" width="20"><a href="fsmenvmmd.html">
		<img align="bottom" alt="FSMenvmmd" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<script type ="text/javascript" language="javaScript">
document.write(barra);
</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->

</body>

</html>
