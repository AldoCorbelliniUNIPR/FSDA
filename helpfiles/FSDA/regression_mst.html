<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">


<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>Variable Selection :: Robust Regression Analysis (Flexible Statistics Data Analysis Toolbox&trade;)</title>
<link href="docstyle.css" rel="stylesheet" type="text/css">
<meta content="refpage" name="chunktype">

<meta content="DocBook XSL Stylesheets V1.52.2" name="generator">
<meta content="Visualizing relationships among variables" name="description">
<meta content="text/javascript" http-equiv="Content-Script-Type">
<script  type="text/javascript" language="javaScript" src="bottom.js"></script>

</head>


<body>

<a name="top_of_page"></a>
<p style="font-size: 1px;">&nbsp;</p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr>
		<td valign="baseline"><b>Flexible Statistics Data Analysis Toolbox&trade;</b></td>
		<td align="right" valign="baseline"><a href="regressionms_intro.html">
		<img align="bottom" alt="Introduction" border="0" src="images_help/b_prev.gif"></a>&nbsp;&nbsp;
		<a href="regression_mscp.html">
		<img align="bottom" alt="Robust Multivariate Methods" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<a name="bqvsgfl-1"></a>
<h2 id="bqvsgfl-1" class="title">Robust Forward Variable Selection using Added t tests
</h2>
<a class="indexterm" name="zmw57dd0e2698"></a>
<p></p>
<p>Since the search orders the observations by the magnitude of their residuals 
from the fitted subsets, the value of s<sup>2</sup> increases during the search, although not 
necessarily monotonically. As a consequence, even in the absence of outliers and 
model inadequacies, the values of the t-statistics for the parameters in the model 
decrease during the search and are hard to interpret. Atkinson and Riani (2002) 
in order to overcome this problem use the method of added variables to provide plots 
of t-tests which are orthogonal to the search.</p>
<p>In order to obtain useful forward plots of t-tests we write the regression model for all n observations
as</p>
<p><img src="plots/wpr4w6td.gif"></p>
<p>where <em>Q</em> is n×p, the errors ɛ satisfy the second-order assumptions with variances 
σ<sup>2</sup> and <em>γ</em> is a
scalar. In turn we take each of the columns of <em>Q</em> as the vector <em>w</em>, except for the column corresponding
to the constant term in the model. The well-established approach of added variables (see 
for example Atkinson and 
Riani, 2000, § 2.2) leads to an expression for the least squares estimator of 
<em>γ</em>
as a function of residuals
from the regression of y and <em>w</em> on <em>X.</em></p>
<p>More specifically:</p>
<p><img alt="" src="plots/img67.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<img alt="" src="plots/img69.gif"></p>
<p>The residual mean square estimator of <em>s</em><sup>2</sup> from
regression on <em>X</em> and <em>w</em>, can be written as</p>
<img alt="" src="plots/img24.gif"><br>
<p>The t-statistic for testing that <em>γ</em>=0 (<em>t<sub>γ</sub></em>) is thus</p>
<p><img alt="" src="plots/img72.gif"></p>
<p>This added-variable test is not affected by the ordering of the data and so has 
the required <em>t</em> distribution.</p>
<p>More precisely, in searches using the added-variable test, we fit the reduced 
model E(<em>Y</em>)=<em>Xb</em>, the residuals from which are used to determine the progress of the 
search. We do not include <em>w</em> in the model. The choice of observations to be included 
in the subset thus depends only on <em>y</em> and <em>X</em>. The ordering of observations using
<em>X</em> 
therefore does not affect the null distribution of the test statistic.</p>
<h3>Example 1</h3>
<p>In the analysis which follows we analyze the transformed fidelity data which 
have been used in previous pages and other dataset</p>
<pre class="programlisting">
% Load the data
load('loyalty.txt');
% define y and X
y=loyalty(:,4);
X=loyalty(:,1:3);
% transform y
y1=y.^(0.4);
% Compute forward added T tests
[out]=FSRaddt(y1,X,&#39;plots&#39;,1,&#39;quant&#39;,[0.025 0.975]);
</pre>
<p>The monitoring of added T-tests shows that the values of the coefficient for 
X1 rises steadily during the forward search and it is not influenced by the entrance 
of the final observations. Same thing for X3 even if this variable even if significant 
is less important than X3 to explain the variability of the response. </p>
<p>For the search which excludes X2 we can see that while in the central part of 
search the curve lies close to the rejection region, in the part m=400 -m=500 the 
curve lies above out of the rejection line. Finally the units which enter the search 
in the final part make the value of T-statistic become non significant. </p>
<p><img alt="" src="images_help/imgC6.gif"> </p>
<br>
<h3>Example 2</h3>
<p><br>Neter et al. (1996, pp. 334, 438) analyse 108 observations on the times of survival 
of patients who had a particular kind of liver surgery. The four explanatory variables 
are as follows: 
<br>x1 is a blood clotting score; 
<br>x2 is a prognostic index, which includes the age of the patient; 
<br>x3 is an enzyme function test score; 
<br>x4 is a score for liver function. 

The response is survival time. </p>
<p>We follow Neter et al. (1996) and 
use the logarithm to base ten of time as the response. It seems clear when all 108 observations 
are fitted that the constant and the first three explanatory variables are all highly 
significant, but that x4 need not be included in the model. We now investigate how 
this conclusion depends on individual observations. In order to use the method of 
added variables, each has to be omitted in turn and be treated as the added variable 
w. Four forward searches are therefore used, each using three of the four variables. 
The resulting plot of the four forward t-statistics is in Figure below.
</p>

<pre class="programlisting">
load('hospital.txt');
y1=hospital(:,5);
X=hospital(:,1:4);
% Compute forward added T tests
[out]=FSRaddt(y1,X,'plots',1,'quant',[0.025 0.975]);
</pre>


<p>These curves behave 
as we would hope: initially no variable is significant, although x3 is briefly significant 
at the 1% level around m=20. The curves then rise smoothly to their values when 
m=n, with the nonsignificant value of t4 showing seemingly random fluctuations.
</p>
<p>The trajectory is devoid of sudden jump and this indicates the absence of individual 
influential observations. </p>
<p><img alt="" src="images_help/hospMS.gif">&nbsp;</p>


<h3>See Also</h3>

<p><a href="addt.html"><tt>addt</tt></a>, <a href="fsraddt.html"><tt>FSRaddt</tt></a>.</p>


<p></p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr valign="top">
		<td align="left" width="20"><a href="regressionms_intro.html">
		<img align="bottom" alt="Robust model selection (introduction)" border="0" src="images_help/b_prev.gif"></a>
		</td>
		<td align="left">Robust model selection (introduction)</td>
		<td>&nbsp;</td>
		<td align="right">Robust model selection using Cp</td>
		<td align="right" width="20"><a href="regression_mscp.html">
		<img align="bottom" alt="Model selection using Cp" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<script type ="text/javascript" language="javaScript">
document.write(barra);
</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->

</body>

</html>
