<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<!--FScategory:Dynamic Statistical Visualization-->

<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>resfwdplot :: Functions (Flexible Statistics Data Analysis Toolbox™)</title>
<link href="docstyle.css" rel="stylesheet" type="text/css">
<meta content="refpage" name="chunktype">
<style type="text/css">
.style1 {
	background-color: #F2F2F2;
}
</style>
<script  type="text/javascript" language="javaScript" src="bottom.js"></script>

</head>


<body>

<a name="top_of_page"></a>
<p style="font-size: 1px;">&nbsp;</p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr>
		<td valign="baseline"><b>Flexible Statistics Data Analysis Toolbox™</b></td>
		<td align="right" valign="baseline"><a href="rescale.html">
		<img align="bottom" alt="resindexplot" border="0" src="images_help/b_prev.gif"></a>&nbsp;&nbsp;
		<a href="resindexplot.html">
		<img align="bottom" alt="score" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<a name="bq24of9-1"></a><a class="indexterm" name="zmw57dd0e69698"></a>
<h1 class="reftitle">resfwdplot</h1>
<p class="purpose">Plots the (scaled) residuals for all units in each step of the 
forward search. </p>
<h2>Syntax </h2>
<p class="synopsis"><tt>resfwdplot(out)<br>resfwdplot(out,<i><tt>param1</tt></i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)<br>
</tt><tt>plotopt=resfwdplot(out,<i>&#39;msg&#39;,1,param1</i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)<br>
</tt></p>
<a name="bq24of9-2"></a>
<h2>Description</h2>
<p><tt>resfwdplot(out)</tt> plots the trajectories of scaled residuals in each step 
of the forward search. The input argument of this function may be conveniently produced 
by function FSReda. It is worthwhile to remark the difference between function resfwdplot 
which shows a &#39;movie&#39; of the residuals, i.e. it enables to show how the residuals 
for each unit evolve as the subset size increases from function resindexplot which 
shows the static plot of residuals against index number or fitted value or against 
any other statistic.&nbsp; </p>
<p>The trajectories of the residuals are divided into 3 parts. Those which have 
to be highlighted (they are called trajectories in foreground), those which have 
to be displayed in faint color or hidden (they are called background trajectories)&nbsp; 
or the remaining ones (they are called standard trajectories). </p>
<p><tt>plotopt=resfwdplot(out,&#39;msg&#39;,1)</tt> enables to save inside cell plotopt the 
options which have been used to draw the three types of trajectories (standard, 
foreground and background). Notice that if msg=2 the options are not only saved, but also printed on the screen.&nbsp; </p>
<p><tt><a name="bq24of9-3"></a>resfwdplot(out)</tt> needs as input the following information
</p>
<ul type="disc">
	<li><tt>out</tt> - A structure of additional statistics with the following fields.
	<ul type="circle">
		<li>
		<p><tt>RES</tt> - A matrix containing the residuals monitored in each step 
		of the forward search. Every row is associated with a unit. This matrix 
		can be created using function FSReda (compulsory argument) </p>
		</li>
		<li><tt>Un</tt> = matrix containing the order of entry of each unit (necessary 
		if <tt>datatooltip</tt> is true or databrush is not empty) </li>
		<li><tt>y</tt> − a vector containing the response (necessary only if option
		<tt>databrush</tt> is not empty) </li>
		<li><tt>X</tt> − a matrix containing the explanatory variables (necessary 
		only if option databrush is not empty) </li>
		<li><tt>Bols − (n-init+1) x (p+1)</tt> matrix containing the monitoring 
		of estimated beta coefficients in each step of the forward search (necessary 
		only if option <tt>databrush</tt> is not empty and suboption <tt>lineadd</tt> 
		is not empty </li>
	</ul>
	</li>
</ul>
<p></p>
<p><tt>resfwdplot(out,<i><tt>param1</tt></i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)</tt> 
specifies one or more of the name/value pairs described in the following table.</p>
<table border="2" cellpadding="4" cellspacing="0" class="body">
	<colgroup>
		<col width="21%"><col width="79%">
	</colgroup>
	<thead>
		<tr valign="top">
			<th bgcolor="#B2B2B2">Parameter</th>
			<th bgcolor="#B2B2B2">Value</th>
		</tr>
	</thead>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;standard&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Structure which defines the appearance of the plot in terms of xlim, 
		ylim, axes labels and their font size style, color of the lines, etc. The 
		structure contains the following fields:
		<table border="2" cellpadding="4" cellspacing="0" class="body">
			<tr valign="top">
				<td bgcolor="#F2F2F2"><tt>&#39;SizeAxesNum&#39;</tt></td>
				<td bgcolor="#F2F2F2">
				<p>scalar specifying the fontsize of the axes numbers. Default value 
				is 10. </p>
				</td>
			</tr>
			<tr>
				<td bgcolor="#F2F2F2" style="height: 53px"><tt>&#39;xlim&#39;</tt></td>
				<td bgcolor="#F2F2F2" style="height: 53px">
				<p>Vector with two elements controlling minimum and maximum on the 
				x axis. Default value is &#39;&#39; (automatic scale).</p>
				</td>
			</tr>
			<tr>
				<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;ylim&#39;</tt></td>
				<td bgcolor="#F2F2F2" style="height: 54px">
				<p>Vector with two elements controlling minimum and maximum on the 
				x axis. Default value is &#39;&#39; (automatic scale)</p>
				</td>
			</tr>
			<tr>
				<td bgcolor="#F2F2F2"><tt>&#39;titl&#39;</tt></td>
				<td bgcolor="#F2F2F2">
				<p>A label for the title (default: &#39;&#39;).</p>
				</td>
			</tr>
			<tr>
				<td bgcolor="#F2F2F2"><tt>&#39;labx&#39;</tt></td>
				<td bgcolor="#F2F2F2">
				<p>A label for the x-axis (default: &#39;Subset size m&#39;)</p>
				</td>
			</tr>
			<tr>
				<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;laby&#39;</tt></td>
				<td bgcolor="#F2F2F2" style="height: 32px">
				<p>A label for the y-axis (default: &#39;Scaled residuals&#39; or &#39;Scaled 
				squared residuals&#39;).</p>
				</td>
			</tr>
			<tr>
				<td bgcolor="#F2F2F2"><tt>&#39;SizeAxesLab&#39;</tt></td>
				<td bgcolor="#F2F2F2">
				<p>Scalar specifying the fontsize of the labels of the axes. Default 
				value is 12. </p>
				</td>
			</tr>
			<tr>
				<td bgcolor="#F2F2F2"><tt>&#39;LineWidth&#39;</tt></td>
				<td bgcolor="#F2F2F2">
				<p>Scalar specifying line width for the trajectories. </p>
				</td>
			</tr>
			<tr>
				<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;Color&#39;</tt></td>
				<td bgcolor="#F2F2F2" style="height: 54px">
				<p>Cell array of strings containing the colors to be used for the 
				highlighted units. If length(Color)=1 the same color will be used 
				for all units. If length(Color)=2 half of the trajectories will 
				appear with Color{1} and the other half with Color{2}. And so on 
				with 3 cell elements, etc.</p>
				</td>
			</tr>
			<tr>
				<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;LineStyle&#39;</tt></td>
				<td bgcolor="#F2F2F2" style="height: 54px">
				<p>Cell containing the line types</p>
				</td>
			</tr>
			<tr>
				<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;subsize&#39;</tt></td>
				<td bgcolor="#F2F2F2" style="height: 54px">
				<p>numeric vector containing the subset size with length equal to 
				the number of columns of matrix residuals. The default value of 
				subsize is size(residuals,1)-size(residuals,2)+1:size(residuals,1)</p>
				</td>
			</tr>
		</table>
		</p>
		The default values of structure standard are<br>standard.SizeAxesNum=1<br>
		standard.SizeAxesNum=10<br>standard.SizeAxesLab=12<br>standard.xlim=&#39;&#39; (Automatic 
		scale)<br>standard.ylim=&#39;&#39; (Automatic scale)<br>standard.titl=&#39;&#39; (empty 
		title)<br>standard.labx=&#39;Subset size m&#39;<br>standard.laby=&#39;Scaled residuals&#39;<br>
		standard.LineWidth=1<br>standard.Color={&#39;b&#39;}<br>standard.LineStyle={&#39;-&#39;}<br>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;fground&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Structure which defines the trajectories in foreground, that is which 
		trajectories are highlighted and how they are plot to be distinguishable 
		from the others. It is possible to control the label, the width, the color, 
		the line type and the marker of the highlighted units. Structure fground 
		contains the following fields:
		<table border="2" cellpadding="4" cellspacing="0" class="body">
			<tr valign="top">
				<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;SizeAxesNum&#39;</tt></td>
				<td bgcolor="#F2F2F2" style="height: 32px">
				<p>scalar specifying the fontsize of the axes numbers. Default value 
				is 10. </p>
				</td>
			</tr>
			<tr>
				<td bgcolor="#F2F2F2" style="height: 53px"><tt>&#39;fthresh&#39;</tt></td>
				<td bgcolor="#F2F2F2" style="height: 53px">
				<p>(alternative to funit) numeric vector of length 1 or 2 which 
				specifies the highlighted trajectories. <br>If length(fthresh)=1 
				the highlighted trajectories are those of units that throughtout 
				the search had at leat once a residual greater (in absolute value) 
				than thresh. The default value of fthresh is 2.5. <br>If length(fthresh)=2 
				the highlighted trajectories are those of units that throughtout 
				the search had a residual at leat once bigger than fthresh(2) or 
				smaller than fthresh(1).</p>
				</td>
			</tr>
			<tr>
				<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;funit&#39;</tt></td>
				<td bgcolor="#F2F2F2" style="height: 54px">
				<p>(alternative to fthresh) vector containing the list of the units 
				to be highlighted. If funit is supplied, fthresh is ignored.</p>
				</td>
			</tr>
			<tr>
				<td bgcolor="#F2F2F2"><tt>&#39;flabstep&#39;</tt></td>
				<td bgcolor="#F2F2F2">
				<p>numeric vector which specifies the steps of the search where 
				to put labels for the highlighted trajectories (units). The default 
				is to put the labels at the initial and final steps of the search. 
				flabstep=&#39;&#39; means no label</p>
				</td>
			</tr>
			<tr>
				<td bgcolor="#F2F2F2"><tt>&#39;LineWidth&#39;</tt></td>
				<td bgcolor="#F2F2F2">
				<p>scalar specifying line width for the highlighted trajectories 
				(units). Default is 1.</p>
				</td>
			</tr>
			<tr>
				<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;Color&#39;</tt></td>
				<td bgcolor="#F2F2F2" style="height: 54px">
				<p>cell array of strings containing the colors to be used for the 
				highlighted trajectories (units). If length(scolor)==1 the same 
				color will be used for all highlighted units Remark: if for example 
				length(scolor)=2 and there are 6 highlighted units, 3 highlighted 
				trajectories appear with selunitcolor{1} and 3 highlighted trajectories 
				with selunitcolor{2}</p>
				</td>
			</tr>
			<tr>
				<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;LineStyle&#39;</tt></td>
				<td bgcolor="#F2F2F2" style="height: 54px">
				<p>Cell containing the line types of the highlighted trajectories.</p>
				</td>
			</tr>
			<tr>
				<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;fmark&#39;</tt></td>
				<td bgcolor="#F2F2F2" style="height: 54px">
				<p>scalar controlling whether to plot highlighted trajectories as 
				markers. if 1 each line is plotted using a different marker else 
				no marker is used (default).</p>
				</td>
			</tr>
			<tr>
				<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;FontSize&#39;</tt></td>
				<td bgcolor="#F2F2F2" style="height: 54px">
				<p>scalar controlling font size of the labels of&nbsp;                       the trajectories in foreground</p>
				</td>
			</tr>
		</table>
		</p>
		The default values of structure fground are<br>fground.flabstep=[m0 n]<br>
		fground.ftresh=2.5<br>fground.LineWidth=1<br>fground.LineStyle={&#39;-&#39;}<br>
		fground.fmark=0<br>fground.FontSize=12<br>
		Remark: if fground=&#39;&#39; no unit is highlighted and no label is inserted into 
		the plot. </td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;bground&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>structure which specifies the trajectories in background, i.e. the trajectories 
		corresponding to &quot;unimmportant&quot; units in the central part of the data. The 
		structure also specifies the style used in the plot to give them less emphasis, 
		so that to not distract the eye of the analyst from the trajectories of 
		the relevant units. The structure contains the following fields:
		<table border="2" cellpadding="4" cellspacing="0" class="body">
			<tr valign="top">
				<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;bthresh&#39;</tt></td>
				<td bgcolor="#F2F2F2" style="height: 32px">
				<p>numeric vector of length 1 or 2 which specifies how to define 
				the unimmportant trajectories. Unimmportant trajectories will be 
				plotted using a colormap, in greysh or will be hidden. <br>- If 
				length(thresh)=1 the irrelevant units are those which always had 
				a residual smaller (in absolute value) than thresh. <br>- If length(bthresh)=2 
				the irrelevant units are those which always had a residual greater 
				than bthresh(1) and smaller than bthresh(2). <br>The default is: 
				bthresh=2.5 if n&gt;100 and bthresh=-inf if n&lt;=100 i.e. to treat all 
				trajectories as important if n&lt;=100 and, if n&gt;100, to reduce emphasis 
				only to trajectories having in all steps of the search a value of 
				scaled residual smaller than 2.5. </p>
				</td>
			</tr>
			<tr>
				<td bgcolor="#F2F2F2" style="height: 53px"><tt>&#39;bstyle&#39;</tt></td>
				<td bgcolor="#F2F2F2" style="height: 53px">
				<p>specifies how to plot the unimportant trajectories as defined 
				in option bthresh. &#39;faint&#39;: unimportant trajectories are plotted 
				using a colormap. &#39;hide&#39;: unimportant trajectories are hidden. &#39;greysh&#39;: 
				unimportant trajectories are displayed in a faint grey. When n&gt;100 
				the default option is &#39;faint&#39;. When n&lt;=100 thresh = -Inf and option 
				bstyle is ignored.</p>
				</td>
			</tr>
		</table>
		</p>
		The default values of structure bground are<br>bground.bthresh=2.5<br>bground.bstyle=&#39;faint&#39;<br>
		(if n&gt;100)<br><br>bground.bthresh=-inf<br>(if n&lt;=100)<br><br>Remark:
		<span class="style1">bground=&#39;&#39; is equivalent to bground.thresh=-Inf<br>
		that is all trajectories are considered relevant.&nbsp; </td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;tag&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>String which identifies the handle of the plot which is about to be created. 
		The default is to use tag &#39;pl_resfwd&#39;. Notice that if the program finds a plot 
		which has a tag equal to the one specified by the user, then the output 
		of the new plot overwrites the existing one in the same window else a new 
		window is created</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;datatooltip&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>Empty value, scalar or structure.    If it is an empty value is inactive. The default is
                  datatooltip = 1, i.e. the user can select with the
                  mouse an individual residual trajectory in order to
                  have information about the corresponding unit, the
                  associated label and the step of the search in which
                  the unit enters in the subset.
                  <br>If datatooltip is a structure, the fields 
                  <tt>DisplayStyle</tt> and <tt>SnapToDataVertex</tt> 
                  control the data cursor features
                  (see the MATLAB function datacursormode or the examples
                  below). <br>Default values are <tt>datatooltip.DisplayStyle =
                  'Window'</tt> and <tt>datatooltip.SnapToDataVertex = 'on'</tt>.
                  <br>By default, the residual trajectory selected with the
                  mouse is highlighted in red. A different color can be
                  specified as RGB vector in the structure field
                  LineColor (a RGB vector can be conveniently chosen
                  with our MATLAB class FSColor, see documentation).
                  <br>By setting the field 
                  <tt>datatooltip.SubsetLinesColor</tt>, 
                  it is also possible to highlight the trajectories of
                  units that are in the subset at a given step of the
                  search.
                  This can be done (repeatedly) with a left mouse click
                  in proximity of the step of interest. A right mouse
                  click will terminate the selection by marking with a
                  up-arrow the step corresponding to the highlighted
                  lines. The highlighted lines by default are in blue,
                  but different colors can be specified as RGB vectors in
                  the field SubsetLinesColor. By default SubsetLinesColor
                  = '', i.e. the modality is not active. Any
                  initialization for SubsetLinesColor which cannot be
                  interpreted as RGB vector will be converted to blue,
                  i.e. SubsetLinesColor will be forced to be [0 0 1].
</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;databrush&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Empty value scalar or structure. If databrush
=&#39;&#39; (default) brushing 
		is not enabled else if it is a scalar it is possible to brush 
		trajectories with the mouse using all default options. The core of this option is <tt>selectdataFS</tt>, a function used by 
		all graphic tools of the FSDA toolbox. A separate common page details all
		options of structure
		<a href="databrushoption.html"><tt>databrush</tt></a>. </p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;label&#39;</tt></td>
		<td bgcolor="#F2F2F2">Cell containing the labels of the units (optional 
		argument used when <tt>datatooltip=1</tt>. If this field is not present 
		labels row1, ..., rown will be automatically created and included in the 
		pop up <tt>datatooltip</tt> window) </td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;nameX&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>cell array of strings of length <em>p</em> containing the labels of the 
		variables of the regression dataset. If it is empty (default) the sequence
		<em>X</em><sub>1</sub>, ..., <em>X</em><sub>p</sub> w will be created automatically..</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;namey&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">character containing the label 
		of the response.</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;msg&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">scalar which controls whether 
		to display or to save the options inside structures standard, fground and bground which have been used to draw the plot.
		<br><tt>plotopt=resfwdplot(out,&#39;msg&#39;,1)</tt> 
		enables to save inside cell <tt>plotopt</tt> the options which have been used to 
		draw the three types of trajectories (standard, foreground and background)
		<br><tt>plotopt=resfwdplot(out,&#39;msg&#39;,2)</tt> 
		saves inside cell <tt>plotopt</tt> the options which have been used and prints them on the screen,
		else (default) nothing is saved or printed 
		on the screen</td>
	</tr>
</table>
<p></p>
<a name="bq9x7hn"></a><a name="bq5gf2y"></a>
<h3>Examples</h3>
<h3>Example 1</h3>
<p>In the first example we show the monitoring residuals plot for the famous stack 
loss data. We first plot the monitoring of residuals with sign and later the squared 
residuals.</p>
<pre class="programlisting">
load(&#39;stack_loss.txt&#39;);
y=stack_loss(:,4);
X=stack_loss(:,1:3);
[out]=LXS(y,X,&#39;nsamp&#39;,10000);
[out1]=FSReda(y,X,out.bs,&#39;init&#39;,5);
% Plot of monitoring of residuals
resfwdplot(out1)
% Create scaled squared residuals
out1.RES=out1.RES.^2;
resfwdplot(out1)
</pre>
<img height="509" src="plots/stack0.gif" width="688">
<img src="plots/stack1.gif">
<p></p>
<h3>Example 2</h3>
<p>In the second example we use the same set of simulated data which had been already 
used in page <a href="lxs.html">LXS</a> in order to compare the information content 
of the monitoring residuals plot with that of the index plot of robust residuals.</p>
<pre class="programlisting">
state=100;
randn(&#39;state&#39;, state);
n=100;
X=randn(n,3);
bet=[3;4;5];
y=3*randn(n,1)+X*bet;
y(1:20)=y(1:20)+13;
% LMS using 10000 subsamples
[outLXS]=LXS(y,X,&#39;nsamp&#39;,10000);
% Forward Search with EDA purposes
[out]=FSReda(y,X,outLXS.bs);
% Monitoring of scaled residuals
resfwdplot(out);
</pre>
<p><img alt="" src="plots/img46.gif"></p>
<p>If as we have done in page <a href="lxs.html">LXS</a>, we change the seed to 
543 and rerun the code this is the new monitoring residuals plot that we get</p>
<img src="plots/wpd90hig.gif">&nbsp;
<h3>See Also</h3>
<p><a href="mdrplot.html"><tt>mdrplot</tt></a>, <a href="levfwdplot.html"><tt>levfwdplot</tt></a>
</p>
<p></p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr valign="top">
		<td align="left" width="20"><a href="rescale.html">
		<img align="bottom" alt="resindexplot" border="0" src="images_help/b_prev.gif"></a>
		</td>
		<td align="left">rescale.html</td>
		<td>&nbsp;</td>
		<td align="right">resindexplot.html</td>
		<td align="right" width="20"><a href="resindexplot.html">
		<img align="bottom" alt="score" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<script type ="text/javascript" language="javaScript">
document.write(barra);
</script>

</body>

</html>
