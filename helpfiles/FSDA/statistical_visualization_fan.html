<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">


<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>Fan Plot :: Statistical Visualization (Forward Search Data Analysis Toolbox&trade;)</title>
<link href="docstyle.css" rel="stylesheet" type="text/css">
<meta content="refpage" name="chunktype">

<meta content="DocBook XSL Stylesheets V1.52.2" name="generator">
<meta content="Visualizing relationships among variables" name="description">
<meta content="text/javascript" http-equiv="Content-Script-Type">
<script  type="text/javascript" language="javaScript" src="bottom.js"></script>

</head>


<body>

<a name="top_of_page"></a>
<p style="font-size: 1px;">&nbsp;</p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr>
		<td valign="baseline"><b>Forward Search Data Analysis Toolbox&trade;</b></td>
		<td align="right" valign="baseline">
		<a href="statistical_visualization_mdr.html">
		<img align="bottom" alt="Minimum Deletion Residual Plot" border="0" src="images_help/b_prev.gif"></a>&nbsp;&nbsp;
		<a href="statistical_visualization_yx.html">
		<img align="bottom" alt="Dynamic yX Plot" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" class="feedbacklinktop" width="100%">
	<tr>
		<td>&nbsp;</td>
		<td align="right">
		<a href="mailto:toolboxFS@unipr.it?subject=feedback">Provide feedback on FSDA toolbox</a>
</td>
	</tr>
</table>
<a name="bqvsgfl-1"></a>
<h2 id="bqvsgfl-1" class="title">Fan Plot</h2>
<a class="indexterm" name="zmw57dd0e2698"></a>
<p></p>
<p>The “fan plot”
displays the values of the <a href="score.html">score test statistic</a> during the forward
search for different values of the Box-Cox transformation parameter &lambda;.
If the size of the data set is small (i.e. smaller than 100) generally it is enough to consider
the five most common values of &lambda; : &minus;1,&minus;0.5, 0, 0.5 and 1, otherwise a finer grid 
of values of &lambda; may be needed. </p>
<p>In the fan plot we 
perform a separate search for each value of &lambda; which is tested. The data are transformed and a starting point is 
found for each forward search, which then proceeds independently for each values 
of &lambda; 
using the transformed data. </p>

<p>The fan plot allows assessment of the proportion of the data
supporting a particular transformation, information not available from
other methods of analysis.</p>

<p>Suppose you want to produce the fan plot for the wool data. </p>
<pre class="programlisting">
% Load wool data: 27 observations and 3 explanatory variables
XX=load('wool.txt');
y=XX(:,end);
X=XX(:,1:end-1);
% Function FSRfan stores the score test statistic. 
%In this case the five most common values of lambda are considered
[out]=FSRfan(y,X);
% Produce a fan plot and display it on the screen
fanplot(out);
</pre>
<p>The fan plot appears as follows </p>
<p><img alt="" height="589" src="plots/wooll_fan.jpg" width="717"></p>

<p>
Initially&nbsp;
there is no evidence against any transformation. When the subset size <em>m</em> 
is equal to
15 (56% of the data), &lambda; = 1 starts to be rejected. The next rejections are &lambda; =
0.5 at 67% and &minus;1 at 74%. The value of &lambda; = 0 is supported not only
by all the data, but also by our sequence of subsets. The observations
added during the search depend on the transformation. In general, if the
data require transformation and are not transformed, or are insufficiently
transformed, large observations will appear as outliers. Conversely, if the
data are overtransformed, small observations will appear as outliers. This
is exactly what happens here. For &lambda; = 1 and &lambda; = 0.5, working back from
m = 27, the last cases to enter the subset are 19, 20 and 21, which are
the three largest observations. Conversely, for &lambda; = &minus;1 and &lambda; = &minus;0.5 case
9 is the last to enter, preceded by 8 and 7, which are the three smallest
observations. Since the data are in standard order for a 33 factorial, the
patterns of these numbers indicate a systematic failure of the model. For
the log transformation, which produces normal errors, there is no particular
pattern to the order in which the observations enter the forward search.</p>
<p>
Notice that using the option <tt>datatooltip</tt> it is possible to see which  
units enter the search for each particular step. For example, with the code</p>
<pre class="programlisting">
fanplot(out,'datatooltip',1);</pre>
<p>
once the user clicks on step <em>m</em>=25 in the search for &lambda; = 1 the tooltip 
shows&nbsp; the following information.
<p><img alt="" height="601" src="plots/wooll_tooltip.jpg" width="740"></p>
<p>&nbsp;<p>
</p>

<p>Usng the option databrush it is immediately possible 
to see the position of the brushed units in the scatter plot matrix and theire resiudual 
in the monitoring residuals plots (see code and Figure below).
<pre class="programlisting">
fanplot(out,'databrush',1);</pre>
<p>

<p><img alt="" height="528" src="plots/wool_databrush.jpg" width="1227"></p>
<p></p>
<p>
In conclusion: every time
a brushing action is performed on the fan plot, it is possible
to display in an automatic way also the information about the position of
the brushed units in the scatter diagram of y against the required explanatory
variable(s) and to immediately visualize the residuals in the monitoring residuals plot.
</p>
<p></p>

<table border="1" cellpadding="5" cellspacing="0" class="note" summary="Note">
		<tr width="90%">
			<td>
			<b>Note</b>&nbsp;&nbsp; In order to label the 
			residuals which are brushed in the fan plot, the following 
			code can be used:
			<pre class="programlisting">
fanplot(out,'databrush',{'Label' 'on' 'RemoveLabels' 'off'});</pre>
			
			</td>
		</tr>
	</table>

<table border="0" cellpadding="0" cellspacing="0" class="feedbacklinkbot" width="100%">
	<tr>
		<td></td>
		<td align="right">
		<a href="mailto:toolboxFS@unipr.it?subject=feedback">Provide feedback on FSDA toolbox</a>
</td>
	</tr>
</table>
<p></p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr valign="top">
		<td align="left" width="20">
		<a href="statistical_visualization_mdr.html">
		<img align="bottom" alt="Introduction" border="0" src="images_help/b_prev.gif"></a>
		</td>
		<td align="left">Minimum Deletion Residual Plot</td>
		<td>&nbsp;</td>
		<td align="right">Dynamic yX Plot</td>
		<td align="right" width="20">
		<a href="statistical_visualization_yx.html">
		<img align="bottom" alt="Box Plots" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<script type ="text/javascript" language="javaScript">
document.write(barra);
</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->

</body>

</html>
