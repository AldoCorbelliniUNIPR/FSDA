<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<!--FScategory:Robust multivariate analysis and transformations-->


<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>mcd :: Functions (Flexible Statistics Data Analysis Toolbox&trade;™)</title>
<link href="docstyle.css" rel="stylesheet" type="text/css">
<meta content="refpage" name="chunktype">
<meta content="function:mcd" name="refentity">


<script  type="text/javascript" language="javaScript" src="bottom.js"></script>

</head>


<body>

<a name="top_of_page"></a>
<p style="font-size: 1px;">&nbsp;</p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr>
		<td valign="baseline"><b>Flexible Statistics Data Analysis Toolbox&trade;</b></td>
		<td align="right" valign="baseline"><a href="malindexplot.html">
		<img align="bottom" alt="levfwdplot
" border="0" src="images_help/b_prev.gif"></a>&nbsp;&nbsp;
		<a href="mdrplot.html">
		<img align="bottom" alt="minplot" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<a name="bq24of9-1"></a><a class="indexterm" name="zmw57dd0e69698"></a>
<h1 class="reftitle">mcd</h1>
<p class="purpose">Minimum covariance determinant
</p>
<h2>Syntax </h2>
<p class="synopsis"><tt>
	[RAW,REW] = mcd(Y)<br>
	[RAW,REW] = mcd(Y,<i><tt>param1</tt></i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)<br>
	[RAW,REW,<i><tt>varargout</tt></i>] = mcd(Y,...);
</tt></p>

<h2>Description</h2>
<p><tt>[RAW,REW] = mcd(Y)</tt> computes raw and reweighted minimum covariance determinant. 
mcd is a highly robust estimator of multivariate location and scatter. 
The code below exploits the computationally efficient algorithm of Rousseeuw and Van Driessen (1999).

Consistency of the raw MCD estimator of location and scatter at elliptical models, as well as asymptotic
normality of the MCD location estimator has been proved in Butler, Davies PL and Jhun (1993). 
</p>

<p>
<tt>Y</tt> is the <i>n</i>-by-<i>v</i> matrix which contains (in the columns) the values 
of <i>v</i> variables. 

<tt>Y</tt> is optionally returned by the function as part of the output structures <i><tt>RAW</tt></i>
and/or <i><tt>REW</tt></i> if options <i><tt>ysaveRAW</tt></i> and <i><tt>ysaveREW</tt></i> are set to 1.
</p>

<p>
If an optional output variable is specified for <tt>varargout</tt>, the matrix of 
the indices of the samples extracted for computing the estimator is returned in that variable.
</p>


<p><tt><a name="bq24of9-3"></a>[RAW,REW] = mcd(Y)</tt> returns the following information
</p>
<ul type="disc">
	<li><tt>RAW</tt> &minus; A structure with the following fields.
	<ul type="circle">
	
	<li>
		<p><tt>h</tt> &minus; scalar scalar. The number of observations that have
                  determined the MCD estimator</p>
		</li>

	
		<li>
		<p><tt>loc</tt> &minus; 1-by-<i>v</i> vector 
		vector containing mcd estimate of location.
		loc is the mean of the observations for which the determinant of the 
		sample covariance matrix is minimal.
		
		</p>
		</li>
		
		<li>
		<p><tt>cov</tt> − <em>v</em> by <em>v</em> matrix containing robust estimate of the 
		covariance matrix. cov is the estimate of scatter of the h observations 
		for which the determinant of the sample covariance matrix is minimal 
		multiplied by a consistency factor and a small sample correction factor. 
		The consistency factor comes from Tallis and is based on the chi2 
		distribution, and on the ratio h/n. The small sample correction factor is due to Pison et al. 
		to make the estimator unbiased.
                  </p>
		</li>

<li>
		<p><tt>cor</tt> − <em>v</em> by <em>v</em> matrix containing robust estimate of the 
		correlation matrix. 
                  </p>
		</li>

		<li>
		<p><tt>bs</tt> &minus; <em>v</em>+1-by-1 vector containing the units forming subset associated 
		with best estimate (minimum covariance determinant)</p>
		</li>
		<li>
		<p><tt>md</tt> &minus; n x 1 vector containing the estimates of the robust Mahalanobis distances (in squared units).</p>
		</li>
		<li>
		<p><tt>weights</tt> &minus; <i>n</i>-by-1 vector containing weights for each observations. 
		The elements of this vector are 0 or 1. Elements equal 
		to 0 are associated with the outliers. </p>
		</li>
		<li>
		<p><tt>outliers</tt> &minus; this output is present only if <tt>conflev</tt> has been specified. 
		It is a vector containing the list of the units declared as outliers using 
		confidence level specified in input scalar <tt>conflev</tt></p>
		</li>
		<li>
		<p><tt>conflev</tt> &minus; confidence level which is used to declare outliers. 
		Remark: scalar out.conflev will be used to draw the horizontal lines (confidence 
		bands) in the plots</p>
		</li>
		<li>
				<p><tt>singsub</tt> &minus;  Number of subsets without full rank. Notice that if
                      this number is greater than 0.1*(number of
                      subsamples) a warning is produced on the screen </p>
		</li>

<li>
				<p><tt>plane</tt> &minus;  In case of an exact fit, RAW.plane contains the coefficients
                   of a (hyper)plane a_1(x_i1-m_1)+...+a_p(x_ip-m_p)=0
                   containing at least h observations, where (m_1,...,m_p)
                   is the MCD location of these observations. </p>
		</li>

		<li>
		<p><tt>Y</tt> &minus; Data matrix Y. The field is present if option ysaveRAW is set to 1. </p>
		</li>

		<li>
		<p><tt>class</tt> &minus; string containing <tt>&#39;mcd&#39;</tt> </p>
		</li>
	</ul>
	</li>
</ul>
<ul type="disc">
	<li><tt>REW</tt> &minus; A structure with the following fields.
	<ul type="circle">
	
	
		<li>
		<p><tt>loc</tt> &minus; 1-by-<i>v</i> vector 
		vector containing mcd reweighted estimate of location.
		loc is the mean of the observations which have not been declared as outliers 
		(i.e. the observations for which RAW.weights=1). 		
		</p>
		</li>
		
		<li>
		<p><tt>cov</tt> − v x v matrix containing robust reweighted estimate of the 
		covariance matrix. cov is the estimate of scatter of the observations 
		for which RAW.weights=1 
		multiplied by a consistency factor and a small sample correction factor. 
		The consistency factor comes from Tallis and is based on the chi2 
		distribution and&nbsp; on the ratio sum(RAW.weights)/n. The small sample correction factor is due to Pison et al. 
		to make the estimator unbiased.
                  </p>
		</li>

<li>
		<p><tt>cor</tt> − <em>v</em> by <em>v</em> matrix containing robust reweighted estimate of the 
		correlation matrix. 
                  </p>
		</li>



		<li>
		<p><tt>md</tt> &minus; n x 1 vector containing the estimates of the robust Mahalanobis distances (in squared units) 
		from reweighted centroid and covariance matrix.</p>
		</li>
		<li>
		<p><tt>outliers</tt> &minus; this output is present only if <tt>conflev</tt> has been specified. 
		It is a vector containing the list of the units declared as outliers using 
		confidence level specified in input scalar <tt>conflev</tt></p>
		</li>
		
		<li>
		<p><tt>Y</tt> &minus; Data matrix Y. The field is present if option ysaveREW is set to 1. </p>
		</li>

		<li>
		<p><tt>class</tt> &minus; string containing <tt>&#39;mcdr&#39;</tt> </p>
		</li>
	</ul>
	</li>
</ul>
<p></p>
<p></p>
<p><tt>[RAW,REW] = mcd(Y,<i><tt>param1</tt></i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)</tt> 
specifies one or more of the name/value pairs described in the following table.</p>
<table border="2" cellpadding="4" cellspacing="0" class="body">
	<colgroup>
		<col width="21%"><col width="79%">
	</colgroup>
	<thead>
		<tr valign="top">
			<th bgcolor="#B2B2B2">Parameter</th>
			<th bgcolor="#B2B2B2">Value</th>
		</tr>
	</thead>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;bdp&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p> Measures the fraction of outliers the algorithm should resist. Any 
		value between 0 and 0.5. The default value of bdp is 0.5</p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;nsamp&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Number of subsamples which will be extracted to find the robust estimator. 
		If nsamp=0 all subsets will be extracted. They will be <tt>(n choose p)</tt>. 
		Remark: if the number of all possible subset is smaller than 1000 the default 
		is to extract all subsets otherwise just 1000.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;refsteps&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		scalar defining number of refining iterations in each subsample 
		(default = 3).</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;reftol&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>scalar. Default value of tolerance for the refining steps
              The default value is 1e-6;</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;refstepsbestr&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		scalar defining number of refining iterations for each
              best subset (default = 50).</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;reftolbestr&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>scalar. Default value of tolerance for the refining steps
              for each of the best subsets 
              The default value is 1e-8;</p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;bestr&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		scalar defining number of "best betas" to remember from the
              subsamples. These will be later iterated until convergence
              (default=5).</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;conflev&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Scalar between 0 and 1 containing confidence level which is 
              used to declare units as outliers. 
              Usually <tt>0.95, 0.975, 0.99</tt> (individual alpha) 
              or <tt>1-0.05/n, 1-0.025/n, 1-0.01/n</tt> (simultaneous alpha).
              Default value is 0.975</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;nocheck&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>Scalar. If <tt>nocheck=1</tt> no check is performed on matrix Y. As default <tt>nocheck=0</tt>. The controls
              on <tt>h</tt>, <tt>bdp</tt> and <tt>nsamp</tt> still remain.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;plots&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>Scalar or structure.               If plots is a structure or scalar equal to 1, generates
              <br> (1) a plot of Mahalanobis distances against index number.
              The confidence level used to draw the confidence bands for
              the MD is given by the input option conflev. If conflev is
              not specified a nominal 0.975 confidence interval will be
              used.
              <br>
              (2) a scatter plot matrix with the outliers highlighted.</p>
		<p>&nbsp;<br>If plots is a structure it may contain the following fields
<br>
		labeladd : if this option is '1', the outliers in the spm are labelled with their unit row index. The
                      default value is labeladd='', i.e. no label is
                      added.
                  
		<br>nameY : cell array of strings containing the labels of
                      the variables. As default value, the labels which are
                      added are Y1, ...Yv.

		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;msg&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>Scalar which controls whether to display or not messages
              on the screen If <tt>msg=1</tt> (default) messages are displayed
              on the screen about estimated time to compute the estimator
              else no message is displayed on the screen. </p>
		</td>
	</tr>
	
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;ysaveRAW&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
	<p>
	 scalar that is set to 1 to request that the data matrix <tt>Y</tt>  
       is saved into the output structure <tt>RAW</tt>.  
       This feature is meant at simplifying the use of function <tt>malindeplot</tt>. 
       Default is 0, i.e. no saving is done.
      </p>
	</td>
	</tr>

			<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;ysaveREW&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>scalar that is set to 1 to request that the data matrix <tt>Y</tt>  
       is saved into the output structure <tt>REW</tt>.  
       This feature is meant at simplifying the use of function <tt>malindeplot</tt>. 
       Default is 0, i.e. no saving is done.
    </p>
		</td>
		</tr>

	
	</table>
<p></p>
<a name="bq9x7hn"></a><a name="bq5gf2y"></a>
<h3>Examples</h3>

<h3>Example 1</h3>

<p>
In these examples we use the same data which have been used 
in the help of function <a href="fsm.html">FSM</a> in order to compare the output of different procedures.
</p>


<pre class="programlisting">
state=100;
randn('state', state);
n=200;
v=3;
Y=randn(n,v);
Ycont=Y;
Ycont(1:5,:)=Ycont(1:5,:)+3;
[RAW,REW]=mcd(Ycont,&#39;conflev&#39;,0.99,'ysaveRAW',1);
</pre>


<p>For outlier detection we consider both the nominal individual 1% significance 
level and the simultaneous Bonferroni confidence level.&nbsp; </p>

<pre class="programlisting">
% Define nominal confidence level
conflev=[0.99,1-0.01/n];

% Define the main title of the plots
titl='';

% Robust Mahalanobis distances from raw MCD
laby='Robust raw MCD Mahalanobis distances'; 
malindexplot(RAW.md,v,'conflev',conflev,'laby',laby,'title',titl)
</pre>
<p>
<img alt="" src="images_help/img42.gif"></p>


<p>
In this example mcd estimator (using 1% Bonferroni threshold) seems to 
detect 4 genuine outliers and one good unit. The output is the same as that of
<a href="fsm.html">FSM</a>.</p>
<p>Using reweighted MCD we obtain</p>
<pre class="programlisting">
% Robust Mahalanobis distances from reweighted MCD
laby='Robust reweighted MCD Mahalanobis distances'; 
malindexplot(REW.md,v,'conflev',conflev,'laby',laby,'title',titl)
</pre>


<p>
<img alt="" src="images_help/img52.gif"></p>

<h3>Example 2</h3>
<p>If in the previous code we change the seed to 543 (state=543) we obtain the following 
results:</p>
<p>Robust distances from using raw MCD.</p>
<p><img alt="" src="images_help/img55.gif"></p>
<p>Robust distances from using reweighted MCD.</p>
<p><img alt="" src="images_help/img58.gif"></p>



You can compare the output with that which comes out from procedure 
<a href="fsm.html">FSM</a>.


<h3>See Also</h3>

<p><a href="mve.html"><tt>MVE</tt></a>, <a href="fsm.html"><tt>FSM</tt></a>, <a href="smult.html"><tt>Smult</tt></a>,
 <a href="mmmult.html"><tt>MMmult</tt></a></p>
<p></p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr valign="top">
		<td align="left" width="20"><a href="malindexplot.html">
		<img align="bottom" alt="levfwdplot
" border="0" src="images_help/b_prev.gif" style="height: 17px"></a>
		</td>
		<td align="left">malindexplot.html</td>
		<td>&nbsp;</td>
		<td align="right">mdrplot.html</td>
		<td align="right" width="20"><a href="mdrplot.html">
		<img align="bottom" alt="malfwdplot" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<script type ="text/javascript" language="javaScript">
document.write(barra);
</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->

</body>

</html>
