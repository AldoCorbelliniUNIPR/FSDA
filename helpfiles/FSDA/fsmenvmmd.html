<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<!--FScategory:Robust multivariate analysis and transformations-->


<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>FSMenvmmd :: Functions (Flexible Statistics Data Analysis Toolbox&trade;)</title>
<link href="docstyle.css" rel="stylesheet" type="text/css">
<meta content="refpage" name="chunktype">


<script  type="text/javascript" language="javaScript" src="bottom.js"></script>

</head>


<body>

<a name="top_of_page"></a>
<p style="font-size: 1px;">&nbsp;</p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr>
		<td valign="baseline"><b>Flexible Statistics Data Analysis Toolbox&trade;</b></td>
		<td align="right" valign="baseline"><a href="fsmeda.html">
		<img align="bottom" alt="FSMeda" border="0" src="images_help/b_prev.gif"></a>&nbsp;&nbsp;
		<a href="fsmfan.html">
		<img align="bottom" alt="FSMfan" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<a name="bq24of9-1"></a><a class="indexterm" name="zmw57dd0e69698"></a>
<h1 class="reftitle">FSMenvmmd</h1>
<p class="purpose">Theoretical envelopes of Minimum Mahalanobis 
Distance outside subset during the search </p>
<h2>Syntax </h2>
<p class="synopsis"><tt>[MMDenv]
= FSMenvmmd(n,p)<br>[MMDenv] = FSMenvmmd(n,p,<i>param1</i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)<br>
</tt></p>
<a name="bq24of9-2"></a>
<h2>Description</h2>
<p><tt>[MMDenv] = FSMenvmmd(n,p)</tt> computes the envelopes of the minimum 
Mahalanobis Distance. This function exploits the link between minimum outside 
subset and m+1th ordered distance together with the relationships between random 
variables. </p>

<p>
<em>n</em> : scalar, number of observations<br>
<br><em>p</em> : number of variables</p>


<p><tt><a name="bq24of9-3"></a>[MMDenv] 
= FSMenvmmd(n,p)</tt> returns the following 
information </p>
<ul type="disc">
	<li>
	<tt>MMDenv</tt> &minus; <tt>(n-m0+1)</tt>-by-<tt>(length(prob)+1)</tt>
              <br>1st col = fwd search index from <tt>m0</tt> to <tt>n-1</tt>
              <br>2nd col = envelope for quantile <tt>prob[1]</tt>
              <br>3rd col = envelope for quantile <tt>prob[2]</tt>
              <br>...
              <br><tt>(k+1)</tt>th col = envelope for quantile <tt>prob[k]</tt>
	<ul>
		<a name="zmw57dd0e69798"></a>
		<table border="1" cellpadding="5" cellspacing="0" class="note" summary="Note">
			<tr width="90%">
				<td>
				<p><b>Note</b>&nbsp;&nbsp; <tt>FSMenvmmd</tt> 
				contains subfunctions
				df, pf and invcdff.</p>
				</td>
			</tr>
		</table>
	</ul>
	</li>
</ul>
<p></p>
<p><tt>[MMDenv] = FSMenvmmd(n,p,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)</tt> 
specifies one or more of the name/value pairs described in the following table.</p>
<table border="2" cellpadding="4" cellspacing="0" class="body">
	<colgroup>
		<col width="21%"><col width="79%">
	</colgroup>
	<thead>
		<tr valign="top">
			<th bgcolor="#B2B2B2">Parameter</th>
			<th bgcolor="#B2B2B2">Value</th>
		</tr>
	</thead>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>'init'</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Scalar which specifies the initial subset size to monitor
              the minimum Mahalanobis distance, if init is not specified it will be set equal to
		floor(n*0.6).</td>
						</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>'prob'</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p> <tt>1</tt>-by-<tt>k</tt>
 vector containing quantiles for which envelopes have
              to be computed. The default is to produce 1%, 50% and 99%
              envelopes.</p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>'exact'</tt></td>
		<td bgcolor="#F2F2F2">
		<p> Scalar, if it is equal to 1 (default) the calculation of the 
		quantiles of F distribution is based on function finv and from the 
		Matlab statistics toolbox, otherwise the 
		calculations of the former quantiles is based on 
		functions invcdff. The solution has a tolerance of 1e-8 ( variable tol 
		in file invcdff.m). Remark: the use of function 
		finv is more precise but requires more time.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>'unscaled'</tt></td>
		<td bgcolor="#F2F2F2">
		<p> Scalar,
		if unscaled is equal to 1 
		(default) the envelopes are produced for unscaled 
		Mahalanobis distances. In other words, Tallis consistency factor is 
		applied else no consistency factor is applied.</p>
		</td>
	</tr>
	</table>
<p></p>
<a name="bq9x7hn"></a><a name="bq5gf2y"></a>
<h3>Examples</h3>

<p>
In this example we compare the accuracy of the envelopes computed with
order statistics with those which come from simulations. 
</p>


<pre class="programlisting">
% Fix a seed 
state=1000;

mtstream = RandStream('shr3cong','Seed',state);
RandStream.setDefaultStream(mtstream);
defaultStream = RandStream.getDefaultStream();
reset(defaultStream)

% If you run this example in a version older than 7.9 replace the previous
% four lines with 
% randn('state', 1000);
n=200;
p=3;

init=100;
nsimul=1000;
mmdStore=zeros(n-init,nsimul);

for j=1:nsimul
Y=randn(n,p);
[fre]=unibiv(Y);
%create an initial subset with the 20 observations with the lowest
%Mahalanobis Distance
fre=sortrows(fre,4);
bs=fre(1:20,1);
mmd = FSMmmd(Y,bs,'init',init);
mmdStore(:,j)=mmd(:,2);
end

% Sort rows of matrix mmdStore
mmdStore=sort(mmdStore,2);

% Create figure which compares empirical and theoretical forward envelopes
% for minimum deletion residual
figure;
hold('on');
quant=[0.01 0.5 0.99];
sel=round(nsimul*quant);
% Plot lines of empirical quantiles
line(mmd(:,1),mmdStore(:,sel),'LineStyle','--','Color','g');
% Plots lines of theoretical quantiles using order statistics
mmdT=FSMenvmmd(n,p,'exact',1,'init',init);
line(mmdT(:,1),mmdT(:,2:4),'LineStyle','-','Color','r');
xlabel('Subset size m');
</pre>

<p>The plot you get is displayed below. The agreement between the two sets of 
bands appears good.</p>
<p>
<img src="plots/fsmenvmmd1.gif">&nbsp;</p>
&nbsp;<h3>See Also</h3>

<p><a href="fsmmmd.html"><tt>FSMmmd</tt></a>, <a href="fsm.html"><tt>FSM</tt></a></p>
<p></p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr valign="top">
		<td align="left" width="20"><a href="fsmeda.html">
		<img align="bottom" alt="FSMeda" border="0" src="images_help/b_prev.gif"></a>
		</td>
		<td align="left">fsmeda.html</td>
		<td>&nbsp;</td>
		<td align="right">fsmfan.html</td>
		<td align="right" width="20"><a href="fsmfan.html">
		<img align="bottom" alt="FSMfan" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<script type ="text/javascript" language="javaScript">
document.write(barra);
</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->

</body>

</html>
