<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">


<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>Forward Search EDA :: Robust Regression Analysis (Flexible Statistics Data Analysis Toolbox&trade;)</title>
<link href="docstyle.css" rel="stylesheet" type="text/css">
<meta content="refpage" name="chunktype">


<script  type="text/javascript" language="javaScript" src="bottom.js"></script>

</head>


<body>

<a name="top_of_page"></a>
<p style="font-size: 1px;">&nbsp;</p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr>
		<td valign="baseline"><b>Flexible Statistics Data Analysis Toolbox&trade;</b></td>
		<td align="right" valign="baseline"><a href="multivariatetransf_intro.html">
		<img align="bottom" alt="lillietest" border="0" src="images_help/b_prev.gif"></a>&nbsp;&nbsp;
		<a href="mult_fsmfan.html">
		<img align="bottom" alt="Robust Forward Linear Regression with automatic outlier detection procedure" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" class="feedbacklinktop" width="100%">
	<tr>
		<td>&nbsp;</td>
		<td align="right">
		<a href="mailto:toolboxFS@unipr.it?subject=feedback">Provide feedback on FSDA toolbox</a>
</td>
	</tr>
</table>
<a name="bq24of9-1"></a><a class="indexterm" name="zmw57dd0e69698"></a>
<h2 id="bqvsgfl-1" class="title">Analysis of multivariate transformations</h2>
<p class="purpose">The purpose of this section is to exemplify 
the procedure for finding multivariate transformations. We use a series of 
searches, the parameter values for the transfomration in successive searches 
being guided by the results of previous searches.</p>
<p class="purpose">In order to illustrate the procedure we use 
the Horse Mussels data. There are 82
observations on Horse mussels from New Zealand. The five variables
are:</p>
&nbsp;<p>y<sub>1</sub>: shell length, mm<br><br>y<sub>2</sub>: shell width, mm<br><br>y<sub>3</sub>: 
shell height, mm<br><br>y<sub>4</sub>: shell mass, grams<br><br>y<sub>5</sub>: muscle mass, 
grams.</p>
<p>Our purpose is to see whether multivariate normality
can be obtained by joint transformation of all five variables.</p>
<p>We start with a forward search with untransformed data.
Figure below is the forward plot of the resulting likelihood
ratio test, to be compared with \chi^2_5. The value at the end
of the search is 160.56 and the statistic is significant
throughout the range shown in the figure. The data need to be
transformed.</p>
<pre class="programlisting">
    % Mussels data.
    % FS based on untransformed data H_0:&lambda;=1 for all variables
    load('mussels.mat');
    Y=mussels.data;
    % Figure 4.18 p. 178 of ARC (2004)
    [out]=FSMtra(Y,plotslrt',1);
</pre>
<p>
<img src="images_help/wp3u8kof.gif">
</p>
<p>
To obtain a first idea of a better transformation consider the
forward plot of the estimates of &lambda; in Figure below
</p>
<p>
<pre class="programlisting">
    % Figure 4.19 p. 178 of ARC (2004)
    [out]=FSMtra(Y,'plotsmle',1);
</pre>

<p>
<img src="images_help/wpt7z94z.gif">
</p>
	
<p>These estimates all trend down at the end of the search,
indicating the continuing introduction of units which are further
and further from the untransformed multivariate normal model. The
jump at m=71 is caused by the introduction of unit 78. The
general shape of the curves towards the end of the search suggests
we might try &lambda; = (1, 0.5, 1, 0, 1/3). Although
1/3 is not
one of the standard five values we have previously used, it is
sometimes appropriate for transforming volume, or mass, to have
units of length, which are here the dimension of the first three
variables. The exact values of the transformation parameters are
not crucial, since we can continue to try a variety of forward
searches.

The forward plot of the likelihood ratio statistic for testing
&lambda; = (1, 0.5, 1, 0, 1/3) is in Figure below</p>

<pre class="programlisting">
% Compare plot of lrt with Figure 4.20 p. 178 of ARC (2004)
[out]=FSMtra(Y,'la0',[1 0.5 1 0 1/3],'plotslrt',1);
</pre>

<p>
<img src="images_help/wpa4wrm5.gif"></p>

<p>
This is an appreciable improvement over the former figure which contained LRT using untransformed data and,
indeed, the transformation is almost acceptable at the end of the
search, that is for all the data. However, it is not acceptable at
some earlier stages in the search. So there are some outliers
entering earlier on which are causing the preferred transformation
to change. The forward plot of parameter estimates in
Figure below shows, by the changes in estimates near the end of
the search, that at least some of the outliers are now entering
towards the end.</p>

<pre class="programlisting">
% Compare plot of mle with Figure 4.21 p. 178 of ARC (2004)
[out]=FSMtra(Y,'la0',[1 0.5 1 0 1/3],'plotsmle',1);
</pre>

<p>
<img src="images_help/wptgr96l.gif"></p>

<p>For example, unit 78 now enters when m=80. To find parameter
values for our third search we move to slightly smaller values of
m. At m=75 an outlier appears to be entering which is causing
an appreciable jump in the value of \hat{&lambda;}_5. The
estimates just before this suggest we try &lambda; = (0.5, 0,
0.5, 0, 0), a stronger transformation than before.

This transformation does very well. Figure below is the forward
plot of the likelihood ratio test for &lambda; = (0.5, 0, 0.5, 0,
0).</p>

<pre class="programlisting">
% Compare plot of lrt with Figure 4.22 p. 180 of ARC (2004)
% Compare plot of mle with Figure 4.23 p. 181 of ARC (2004)
[out]=FSMtra(Y,'la0',[0.5 0 0.5 0 0],'plotsmle',1,'plotslrt',1);
</pre>

<p>
<img src="images_help/wptlumso.gif"></p>
<p>
We have found a transformation which is supported by all the data
except the outliers, which enter at the end of the search. The
forward plot of the parameter estimates in Figure below shows
that, until m=79, three of the parameter estimates are stable
around zero and two around 0.5.</p>
<p>
<img src="images_help/wpvrmjti.gif"></p>
<p>
The only one thing which remains to be done is to use the multivariate fan plot to confirm these 
individual values of &lambda;. See page <a href="mult_fsmfan.html">mullt_fsmfan.html</a>
</p>

<h3>See Also</h3>

<p><a href="fsmtra.html"><tt>FSMtra</tt></a>, <a href="fsmfan.html"><tt>FSMfan</tt></a></p>


<table border="0" cellpadding="0" cellspacing="0" class="feedbacklinkbot" width="100%">
	<tr>
		<td>&nbsp;</td>
		<td align="right">
		<a href="mailto:toolboxFS@unipr.it?subject=feedback">Provide feedback on FSDA toolbox</a>
</td>
	</tr>
</table>
<p></p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr valign="top">
		<td align="left" width="20"><a href="multivariatetransf_intro.html">
		<img align="bottom" alt="LMS and LTS estimators" border="0" src="images_help/b_prev.gif"></a>
		</td>
		<td align="left">Introduction to transformations in 
		multivariate analysis</td>
		<td>&nbsp;</td>
		<td align="right">Multivariate transformations: 
		confirmatory analysis</td>
		<td align="right" width="20"><a href="mult_fsmfan.html">
		<img align="bottom" alt="Robust Forward Linear Regression with automatic outlier detection procedure" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<script type ="text/javascript" language="javaScript">
document.write(barra);
</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->

</body>

</html>
