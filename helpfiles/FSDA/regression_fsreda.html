<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">


<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>Forward Search EDA :: Robust Regression Analysis (Flexible Statistics Data Analysis Toolbox&trade;)</title>
<link href="docstyle.css" rel="stylesheet" type="text/css">
<meta content="refpage" name="chunktype">


<script  type="text/javascript" language="javaScript" src="bottom.js"></script>

</head>


<body>

<a name="top_of_page"></a>
<p style="font-size: 1px;">&nbsp;</p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr>
		<td valign="baseline"><b>Flexible Statistics Data Analysis Toolbox&trade;</b></td>
		<td align="right" valign="baseline"><a href="regression_lxs.html">
		<img align="bottom" alt="lillietest" border="0" src="images_help/b_prev.gif"></a>&nbsp;&nbsp;
		<a href="regression_fsr.html">
		<img align="bottom" alt="Robust Forward Linear Regression with automatic outlier detection procedure" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" class="feedbacklinktop" width="100%">
	<tr>
		<td>&nbsp;</td>
		<td align="right">
		<a href="mailto:toolboxFS@unipr.it?subject=feedback">Provide feedback on FSDA toolbox</a>
</td>
	</tr>
</table>
<a name="bq24of9-1"></a><a class="indexterm" name="zmw57dd0e69698"></a>
<h2 id="bqvsgfl-1" class="title">Forward search in linear regression with exploratory data analysis 
(EDA) purposes</h2>
<p class="purpose">Forward search in linear regression used for exploratory data 
analysis (EDA) purposes 
 monitors the evolution of residuals, parameters 
estimates and inferences as the subset size increases. In other words, the results are 
presented as as “forward plots” which show 
the evolution of the quantities of interest as a function of subset size. Therefore, 
unlike other robust approaches, the forward search is a dynamic process that produces 
a sequence of estimates and related plots. 
In this page, in order to compare the output of the forward plots with that based from the 
application of traditional robust estimators we concentrate our attention on the same 
dataset (loyalty cards) which had already been analyzed in page &quot;Least trimmed squares (LTS) and Least median of squares (LMS)&quot;.</p>
<pre class="programlisting">
% Load the data
load('loyalty.txt');
nameX={'Intercept' 'Number of visits', 'Age', 'Number of persons in the family'};
% define y and X
y=loyalty(:,4);
X=loyalty(:,1:3);
% transform y
y1=y.^(0.4);
[out]=LXS(y1,X);
% Use function FSReda (Forward search in linear regression with EDA purposes) in order to store the relevant quantities.
[out]=FSReda(y1,X,out.bs);
</pre>
<p>
In this page in order to illustrate the power of the forward plots to reveal the real structure of the data we give a series of forward plots
</p>

<p>Monitoring residuals plot without labeling any trajectory can be obtained 
from the following code.</p>

<pre class="programlisting">
fground=struct;
fground.flabstep='';
resfwdplot(out,'fground',fground);
</pre>

<img alt="" src="plots/loy1.jpg">
<p>The monitoring residuals plot shows that there is a group of trajectories which 
have a very large negative residual throughout all the central
part of the search and that at the end their trajectories are completely confused
with those of the rest of the data. </p>
<p>Remark: it is interesting to notice the similarity of these trajectories 
during all steps the search: they tend to respond in the same way to the 
inclusion of units into the subset.</p>
<p>&nbsp;</p>
<p>Another plot which helps to reveal the eventual presence of atypical 
observations is the Monitoring of minimum deletion residual among observations not belonging to 
the subset. This plot clearly reveals that in the final part of the search there 
is a set 
of observations whose minimum deletion residual lies well above the 99% simulation envelope. 
It is interesting to notice that the final value of the statistic when m = n &minus; 1
lies inside the envelope, so that the outliers are masked.</p>
<pre class="programlisting">
mdrplot(out);
</pre>

<p>
<img alt="" src="plots/loy2.jpg"></p>
<p>&nbsp;</p>
<p>
<p>In order to understand the effect the last units 
which enter the search exert on the fitted model
we also plot the Monitoring of modified Cook distance</p>

<pre class="programlisting">
plot(out.coo(:,1),out.coo(:,3))
ylabel('Modified Cook distance');
xlabel('Subset size m');
xlim([20 510])
</pre>
<p>This plot shows in the final part of the search, when the outliers 
enter the subset, a big sudden increase.
</p>

<p>
<img alt="" src="plots/loy3.jpg"></p>
<p></p>
<p>In order to understand what are the components of estimated parameter vector&nbsp; 
which is affected mostly by the introduction of the last units we can monitor in 
separate panels the estimates of the elements of the vector of beta. This plot 
can be produced efficiently using the loop which follows:</p>

<pre class="programlisting">
figure;
for j=2:size(out.Bols,2);
    subplot(2,2,j-1)
    plot(out.Bols(:,1),out.Bols(:,j))
    xlim([10 510])
    xlabel('Subset size m');
    ylabel(nameX(j-1));
end
</pre>

<p><img alt="" src="plots/loy4.jpg"></p>
<p>This plot shows that the effect of the outliers is mainly to decrease the estimated 
coefficient&nbsp; linked to the &quot;number of visits&quot; to the supermarket.</p>
<p>The monitoring residuals plot showed that the last observations which enter the search 
are characterized by negative residuals. The monitoring of the normality 
test, especially in the part associated to asymmetry, shows that 
the effect of the units which enter the final part of the search is to produce a distribution with a long left tail and to 
increase considerably the value of the normality test.</p>
<pre class="programlisting">
xlimx=[100 510];
subplot(2,2,1);
plot(out.nor(:,1),out.nor(:,2));
title('Asimmetry test');
xlim(xlimx);

subplot(2,2,2)
plot(out.nor(:,1),out.nor(:,3))
title('Kurtosis test');
xlim(xlimx);

subplot(2,2,3:4)
plot(out.nor(:,1),out.nor(:,4))
xlim(xlimx);
title('Normality test');
xlabel('Subset size m');
</pre>

<p><img alt="" src="plots/loy5.jpg"></p>

<h3>See Also</h3>

<p><a href="fsreda.html"><tt>FSReda</tt></a>, <a href="fsr.html"><tt>FSR</tt></a>,
<a href="lxs.html"><tt>LXS</tt></a></p>


<table border="0" cellpadding="0" cellspacing="0" class="feedbacklinkbot" width="100%">
	<tr>
		<td>&nbsp;</td>
		<td align="right">
		<a href="mailto:toolboxFS@unipr.it?subject=feedback">Provide feedback on FSDA toolbox</a>
</td>
	</tr>
</table>
<p></p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr valign="top">
		<td align="left" width="20"><a href="regression_lxs.html">
		<img align="bottom" alt="LMS and LTS estimators" border="0" src="images_help/b_prev.gif"></a>
		</td>
		<td align="left">LMS and LTS estimators</td>
		<td>&nbsp;</td>
		<td align="right">Robust Forward Linear Regression with automatic outlier detection procedure</td>
		<td align="right" width="20"><a href="regression_fsr.html">
		<img align="bottom" alt="Robust Forward Linear Regression with automatic outlier detection procedure" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<script type ="text/javascript" language="javaScript">
document.write(barra);
</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->

</body>

</html>
