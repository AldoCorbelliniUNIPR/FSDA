<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<!--FScategory:Robust Regression Analysis and transformations-->


<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>FSRenvmdr :: Functions (Flexible Statistics Data Analysis Toolbox&trade;)</title>
<link href="docstyle.css" rel="stylesheet" type="text/css">
<meta content="refpage" name="chunktype">


<script  type="text/javascript" language="javaScript" src="bottom.js"></script>

</head>


<body>

<a name="top_of_page"></a>
<p style="font-size: 1px;">&nbsp;</p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr>
		<td valign="baseline"><b>Flexible Statistics Data Analysis Toolbox&trade;</b></td>
		<td align="right" valign="baseline"><a href="fsreda.html">
		<img align="bottom" alt="FSReda" border="0" src="images_help/b_prev.gif"></a>&nbsp;&nbsp;
		<a href="fsrfan.html">
		<img align="bottom" alt="FSRfan" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" class="feedbacklinktop" width="100%">
	<tr>
		<td>&nbsp;</td>
		<td align="right">
		<a href="mailto:toolboxFS@unipr.it?subject=feedback">Provide feedback on FSDA toolbox</a>
</td>
	</tr>
</table>
<a name="bq24of9-1"></a><a class="indexterm" name="zmw57dd0e69698"></a>
<h1 class="reftitle">FSRenvmdr</h1>
<p class="purpose">Theoretical envelopes of Minimum Deletion Residual outside subset during the search </p>
<h2>Syntax </h2>
<p class="synopsis"><tt>[MDRenv] = FSRenvmdr(n,p)<br>[MDRenv] = FSRenvmdr(n,p,<i>param1</i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)<br>
</tt></p>
<a name="bq24of9-2"></a>
<h2>Description</h2>
<p><tt>[MDRenv] = FSRenvmdr(n,p)</tt> computes the envelopes of the minimum 
deletion residuals. This function exploits the link between minimum outside 
subset and m+1th ordered distance together with the relationships between random 
variables. </p>

<p>
n : scalar, number of observations<br>
<br>p : number of explanatory variables (including the intercept if present)</p>


<p><tt><a name="bq24of9-3"></a>[MDRenv] = FSRenvmdr(n,p)</tt> returns the following 
information </p>
<ul type="disc">
	<li>
	<tt>MDRenv</tt> &minus; <tt>(n-m0+1)</tt>-by-<tt>(length(prob)+1)</tt>
              <br>1st col = fwd search index from <tt>m0</tt> to <tt>n-1</tt>
              <br>2nd col = envelope for quantile <tt>prob[1]</tt>
              <br>3rd col = envelope for quantile <tt>prob[2]</tt>
              <br>...
              <br><tt>(k+1)</tt>th col = envelope for quantile <tt>prob[k]</tt>
	<ul>
		<a name="zmw57dd0e69798"></a>
		<table border="1" cellpadding="5" cellspacing="0" class="note" summary="Note">
			<tr width="90%">
				<td>
				<p><b>Note</b>&nbsp;&nbsp; <tt>FSRenvmdr</tt> contains two subfunctions
				invcdft and invcdff.</p>
				</td>
			</tr>
		</table>
	</ul>
	</li>
</ul>
<p></p>
<p><tt>[MDRenv] = FSRenvmdr(n,p,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)</tt> 
specifies one or more of the name/value pairs described in the following table.</p>
<table border="2" cellpadding="4" cellspacing="0" class="body">
	<colgroup>
		<col width="21%"><col width="79%">
	</colgroup>
	<thead>
		<tr valign="top">
			<th bgcolor="#B2B2B2">Parameter</th>
			<th bgcolor="#B2B2B2">Value</th>
		</tr>
	</thead>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;init&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Scalar which specifies the initial subset size to monitor
              minimum deletion residual, if init is not specified it will
              be set equal to to start monitoring exceedances, 
		if init is not specified it will be set equal to   <br><tt>p+1</tt>,
		 if the sample size is smaller than 40; <br><tt>min(3*p+1,floor(0.5*(n+p+1)))</tt>, 
		 otherwise.</td>
						</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;prob&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p> <tt>1</tt>-by-<tt>k</tt>
 vector containing quantiles for which envelopes have
              to be computed. The default is to produce 1%, 50% and 99%
              envelopes.</p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;exact&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p> Scalar, if it is equal to 1 the calculation of the quantiles
              of the T and F distribution is based on functions finv and
              tinv from the Matlab statistics toolbox, otherwise the
              calculations of the former quantiles is based on functions
              invcdff and invcdft. The solution has a tolerance of 1e-8
              (change variable tol in files invcdff.m and invcdft.m if
              required.
              Remark: the use of functions tinv and finv is more precise
              but requires more time</p>
		</td>
	</tr>
	</table>
<p></p>
<a name="bq9x7hn"></a><a name="bq5gf2y"></a>
<h3>Examples</h3>

<p>
In this example we compare the accuracy of the envelopes computed with
order statistics with those which come from simulations. 
</p>


<pre class="programlisting">
% Fix a seed 
state=1000;

mtstream = RandStream('shr3cong','Seed',state);
RandStream.setDefaultStream(mtstream);
defaultStream = RandStream.getDefaultStream();
reset(defaultStream)

% If you run this example in a version older than 7.9 replace the previous
% four lines with 
% randn('state', 1000);
n=200;p=3;
X=randn(n,p);

init=20;
nsimul=1000;
mdrStore=zeros(n-init,nsimul);

for j=1:nsimul
    y=randn(n,1);
    [out]=LXS(y,X,'nsamp',1000','msg',0);
    mdr = FSRmdr(y,X,out.bs,'init',init);
    mdrStore(:,j)=mdr(:,2);
end

% Sort rows of matrix mdrStore
mdrStore=sort(mdrStore,2);

% Create figure which compares empirical and theoretical forward envelopes
% for minimum deletion residual
figure;
hold('on');
quant=[0.01 0.5 0.99];
sel=round(nsimul*quant);
% Plot lines of empirical quantiles
line(mdr(:,1),mdrStore(:,sel),'LineStyle','--','Color','g');
% Plots lines of theoretical quantiles using order statistics
mdrT=FSRenvmdr(n,p+1,'exact',1,'init',init);
line(mdrT(:,1),mdrT(:,2:4),'LineStyle','-','Color','r');
xlabel('Subset size m');
</pre>

<p>The plot you get is displayed below. The agreement between the two sets of bands appears good 
especially for the upper (99%) confidence band.</p>
<img src="plots/compenv.gif">
<h3>See Also</h3>

<p><a href="fsrmdr.html"><tt>FSRmdr</tt></a>, <a href="fsr.html"><tt>FSR</tt></a></p>
<table border="0" cellpadding="0" cellspacing="0" class="feedbacklinkbot" width="100%">
	<tr>
		<td>&nbsp;</td>
		<td align="right">
		<a href="mailto:toolboxFS@unipr.it?subject=feedback">Provide feedback on FSDA toolbox</a>
</td>
	</tr>
</table>
<p></p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr valign="top">
		<td align="left" width="20"><a href="fsreda.html">
		<img align="bottom" alt="FSReda" border="0" src="images_help/b_prev.gif"></a>
		</td>
		<td align="left">fsreda.html</td>
		<td>&nbsp;</td>
		<td align="right">fsrfan.html</td>
		<td align="right" width="20"><a href="fsrfan.html">
		<img align="bottom" alt="FSRfan" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<script type ="text/javascript" language="javaScript">
document.write(barra);
</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->

</body>

</html>
